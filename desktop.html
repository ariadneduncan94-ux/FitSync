<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>LiftWise - Trainer Dashboard</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    * { box-sizing: border-box; margin: 0; padding: 0; }
    html, body { height: 100%; overflow: hidden; }
    body { font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif; background: #0a0a0a; color: #fff; }
    
    /* Layout */
    .app { display: flex; height: 100vh; overflow: hidden; }
    .sidebar { width: 240px; background: #111; border-right: 1px solid #222; display: flex; flex-direction: column; position: fixed; height: 100vh; z-index: 10; }
    .main { flex: 1; margin-left: 240px; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
    
    /* Sidebar */
    .sidebar-header { padding: 24px 20px; border-bottom: 1px solid #222; }
    .logo { font-family: 'Poppins', sans-serif; font-size: 24px; font-weight: 700; }
    .logo-lift { color: #fff; }
    .logo-wise { background: linear-gradient(90deg, #4169E1, #00ff88); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
    
    .sidebar-nav { flex: 1; padding: 16px 12px; overflow-y: auto; }
    .nav-section { margin-bottom: 24px; }
    .nav-section-title { font-size: 10px; color: #666; letter-spacing: 1.5px; text-transform: uppercase; padding: 0 12px; margin-bottom: 8px; }
    .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 10px; cursor: pointer; color: #888; font-size: 14px; font-weight: 500; transition: all 0.2s; }
    .nav-item:hover { background: #1a1a1a; color: #fff; }
    .nav-item.active { background: linear-gradient(135deg, #4169E120 0%, #00ff8810 100%); color: #fff; border: 1px solid #4169E130; }
    .nav-item svg { width: 20px; height: 20px; fill: currentColor; }
    .nav-badge { margin-left: auto; background: #4169E1; color: #fff; font-size: 11px; padding: 2px 8px; border-radius: 10px; }
    
    .sidebar-footer { padding: 16px; border-top: 1px solid #222; }
    .user-info { display: flex; align-items: center; gap: 12px; padding: 8px; border-radius: 10px; cursor: pointer; }
    .user-info:hover { background: #1a1a1a; }
    .user-avatar { width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #4169E1, #00ff88); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; }
    .user-name { font-weight: 600; font-size: 14px; }
    .user-role { font-size: 11px; color: #666; }
    
    /* Header */
    .header { padding: 12px 24px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center; background: #0a0a0a; flex-shrink: 0; }
    .header-title { font-size: 18px; font-weight: 600; }
    .header-actions { display: flex; gap: 12px; }
    
    /* Content */
    .content { flex: 1; padding: 16px 24px; overflow-y: auto; }
    
    /* Page container */
    .page { display: none; height: 100%; }
    .page.active { display: flex; flex-direction: column; height: 100%; }
    
    /* Cards */
    .card { background: #111; border: 1px solid #222; border-radius: 16px; padding: 20px; }
    .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; }
    .card-title { font-size: 14px; font-weight: 600; color: #888; letter-spacing: 1px; text-transform: uppercase; }
    
    /* Buttons */
    .btn { padding: 12px 20px; background: linear-gradient(135deg, #4169E1 0%, #00ff88 100%); border: none; border-radius: 10px; color: #fff; font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.2s; display: inline-flex; align-items: center; gap: 8px; }
    .btn:hover { transform: translateY(-1px); box-shadow: 0 4px 20px rgba(65, 105, 225, 0.4); }
    .btn-secondary { background: #1a1a1a; border: 1px solid #333; }
    .btn-secondary:hover { border-color: #4169E1; }
    .btn-sm { padding: 8px 14px; font-size: 13px; }
    .btn svg { width: 16px; height: 16px; fill: currentColor; }
    
    /* Grid */
    .grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
    .grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
    .grid-4 { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; }
</style>
</head>
<body>
<div class="app">
  <!-- Sidebar -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <div class="logo"><span class="logo-lift">Lift</span><span class="logo-wise">Wise</span></div>
    </div>
    
    <nav class="sidebar-nav">
      <div class="nav-section">
        <div class="nav-section-title">Overview</div>
        <div class="nav-item active" onclick="showPage('dashboard')">
          <svg viewBox="0 0 24 24"><path d="M3 13h8V3H3v10zm0 8h8v-6H3v6zm10 0h8V11h-8v10zm0-18v6h8V3h-8z"/></svg>
          Dashboard
        </div>
        <div class="nav-item" onclick="showPage('calendar')">
          <svg viewBox="0 0 24 24"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
          Calendar
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-section-title">Clients</div>
        <div class="nav-item" onclick="showPage('clients')">
          <svg viewBox="0 0 24 24"><path d="M16 11c1.66 0 2.99-1.34 2.99-3S17.66 5 16 5c-1.66 0-3 1.34-3 3s1.34 3 3 3zm-8 0c1.66 0 2.99-1.34 2.99-3S9.66 5 8 5C6.34 5 5 6.34 5 8s1.34 3 3 3zm0 2c-2.33 0-7 1.17-7 3.5V19h14v-2.5c0-2.33-4.67-3.5-7-3.5zm8 0c-.29 0-.62.02-.97.05 1.16.84 1.97 1.97 1.97 3.45V19h6v-2.5c0-2.33-4.67-3.5-7-3.5z"/></svg>
          All Clients
          <span class="nav-badge">12</span>
        </div>
        <div class="nav-item" onclick="showPage('messages')">
          <svg viewBox="0 0 24 24"><path d="M20 2H4c-1.1 0-2 .9-2 2v18l4-4h14c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm0 14H6l-2 2V4h16v12z"/></svg>
          Messages
          <span class="nav-badge" style="background:#00ff88;">3</span>
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-section-title">Programming</div>
        <div class="nav-item" onclick="showPage('programs')">
          <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
          Programs
        </div>
        <div class="nav-item" onclick="showPage('studio')">
          <svg viewBox="0 0 24 24"><path d="M22 9V7h-2V5c0-1.1-.9-2-2-2H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2v-2h2v-2h-2v-2h2v-2h-2V9h2zm-4 10H4V5h14v14zM6 13h5v4H6zm6-6h4v3h-4zM6 7h5v5H6zm6 4h4v6h-4z"/></svg>
          Program Studio
        </div>
        <div class="nav-item" onclick="showPage('exercises')">
          <svg viewBox="0 0 24 24"><path d="M20.57 14.86L22 13.43 20.57 12 17 15.57 8.43 7 12 3.43 10.57 2 9.14 3.43 7.71 2 5.57 4.14 4.14 2.71 2.71 4.14l1.43 1.43L2 7.71l1.43 1.43L2 10.57 3.43 12 7 8.43 15.57 17 12 20.57 13.43 22l1.43-1.43L16.29 22l2.14-2.14 1.43 1.43 1.43-1.43-1.43-1.43L22 16.29z"/></svg>
          Exercise Library
        </div>
        <div class="nav-item" onclick="showPage('nutrition')">
          <svg viewBox="0 0 24 24"><path d="M18.06 22.99h1.66c.84 0 1.53-.64 1.63-1.46L23 5.05l-5 2v16.94h.06zM1 21.99h15.03V3.95l-5-2-10 2v18.04zm1.97-13.95l2.56-.51v2.96l-2.56.51V8.04zm0 4.48l2.56-.51v2.96l-2.56.51v-2.96zm0 4.48l2.56-.51v2.96l-2.56.51v-2.96z"/></svg>
          Nutrition
        </div>
        <div class="nav-item" onclick="showPage('ai-coach')">
          <svg viewBox="0 0 40 40" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M8 20h24M12 14v12M28 14v12M6 17h4v6H6zM30 17h4v6h-4z" stroke-linecap="round"/><path d="M20 8l4 6h-8l4-6z" fill="currentColor" stroke="none"/></svg>
          AI Coach
        </div>
      </div>
      
      <div class="nav-section">
        <div class="nav-section-title">Business</div>
        <div class="nav-item" onclick="showPage('revenue')">
          <svg viewBox="0 0 24 24"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
          Revenue
        </div>
        <div class="nav-item" onclick="showPage('settings')">
          <svg viewBox="0 0 24 24"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
          Settings
        </div>
      </div>
    </nav>
    
    <div class="sidebar-footer">
      <div class="user-info">
        <div class="user-avatar">AT</div>
        <div>
          <div class="user-name">Alex Trainer</div>
          <div class="user-role">Pro Plan</div>
        </div>
      </div>
    </div>
  </aside>

<style>
    /* Calendar Styles */
    .calendar-container { display: flex; gap: 24px; height: calc(100vh - 140px); }
    .calendar-main { flex: 1; display: flex; flex-direction: column; }
    .calendar-sidebar { width: 320px; display: flex; flex-direction: column; gap: 16px; }
    
    .calendar-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
    .calendar-nav { display: flex; align-items: center; gap: 16px; }
    .calendar-nav-btn { width: 36px; height: 36px; border-radius: 8px; background: #1a1a1a; border: 1px solid #333; color: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    .calendar-nav-btn:hover { border-color: #4169E1; }
    .calendar-month { font-size: 20px; font-weight: 600; min-width: 180px; text-align: center; }
    .calendar-views { display: flex; gap: 4px; background: #1a1a1a; padding: 4px; border-radius: 10px; }
    .calendar-view-btn { padding: 8px 16px; border: none; background: transparent; color: #888; font-size: 13px; font-weight: 500; cursor: pointer; border-radius: 8px; }
    .calendar-view-btn.active { background: #4169E1; color: #fff; }
    
    .calendar-grid { flex: 1; display: flex; flex-direction: column; background: #111; border: 1px solid #222; border-radius: 16px; overflow: hidden; }
    .calendar-weekdays { display: grid; grid-template-columns: repeat(7, 1fr); background: #1a1a1a; border-bottom: 1px solid #222; }
    .calendar-weekday { padding: 12px; text-align: center; font-size: 12px; font-weight: 600; color: #666; text-transform: uppercase; letter-spacing: 1px; }
    .calendar-days { flex: 1; display: grid; grid-template-columns: repeat(7, 1fr); grid-auto-rows: 1fr; }
    .calendar-day { border-right: 1px solid #222; border-bottom: 1px solid #222; padding: 8px; min-height: 100px; cursor: pointer; transition: background 0.2s; }
    .calendar-day:hover { background: #1a1a1a; }
    .calendar-day:nth-child(7n) { border-right: none; }
    .calendar-day.other-month { opacity: 0.3; }
    .calendar-day.today { background: linear-gradient(135deg, #4169E110 0%, #00ff8808 100%); }
    .calendar-day-num { font-size: 14px; font-weight: 600; margin-bottom: 6px; }
    .calendar-day.today .calendar-day-num { color: #4169E1; }
    .calendar-event { font-size: 11px; padding: 4px 6px; border-radius: 4px; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; cursor: pointer; }
    .calendar-event.session { background: #4169E130; color: #4169E1; border-left: 2px solid #4169E1; }
    .calendar-event.workout { background: #00ff8820; color: #00ff88; border-left: 2px solid #00ff88; }
    .calendar-event.checkin { background: #ffcc0020; color: #ffcc00; border-left: 2px solid #ffcc00; }
    
    /* AI Command Panel */
    .ai-panel { background: #111; border: 1px solid #222; border-radius: 16px; padding: 20px; flex: 1; display: flex; flex-direction: column; }
    .ai-panel-header { display: flex; align-items: center; gap: 12px; margin-bottom: 16px; }
    .ai-panel-icon { width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, #4169E1, #00ff88); display: flex; align-items: center; justify-content: center; }
    .ai-panel-title { font-size: 16px; font-weight: 600; }
    .ai-panel-subtitle { font-size: 12px; color: #666; }
    .ai-input-area { flex: 1; display: flex; flex-direction: column; }
    .ai-textarea { flex: 1; background: #0a0a0a; border: 1px solid #333; border-radius: 12px; padding: 16px; color: #fff; font-size: 14px; resize: none; font-family: inherit; min-height: 120px; }
    .ai-textarea:focus { outline: none; border-color: #4169E1; }
    .ai-textarea::placeholder { color: #555; }
    .ai-suggestions { display: flex; flex-wrap: wrap; gap: 8px; margin: 12px 0; }
    .ai-suggestion { padding: 6px 12px; background: #1a1a1a; border: 1px solid #333; border-radius: 20px; font-size: 12px; color: #888; cursor: pointer; transition: all 0.2s; }
    .ai-suggestion:hover { border-color: #4169E1; color: #fff; }
    .ai-actions { display: flex; gap: 8px; margin-top: 12px; }
    
    /* Today's Schedule */
    .schedule-card { background: #111; border: 1px solid #222; border-radius: 16px; padding: 20px; max-height: 300px; overflow-y: auto; }
    .schedule-item { display: flex; gap: 12px; padding: 12px 0; border-bottom: 1px solid #222; }
    .schedule-item:last-child { border-bottom: none; }
    .schedule-time { font-size: 13px; font-weight: 600; color: #4169E1; min-width: 60px; }
    .schedule-info { flex: 1; }
    .schedule-title { font-size: 14px; font-weight: 500; }
    .schedule-meta { font-size: 12px; color: #666; margin-top: 2px; }
    .schedule-avatar { width: 32px; height: 32px; border-radius: 8px; background: #333; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600; }
    
    /* Stats Cards */
    .stat-card { background: #111; border: 1px solid #222; border-radius: 16px; padding: 20px; }
    .stat-value { font-size: 32px; font-weight: 700; margin-bottom: 4px; }
    .stat-value.green { color: #00ff88; }
    .stat-value.blue { color: #4169E1; }
    .stat-label { font-size: 13px; color: #666; }
    .stat-change { font-size: 12px; margin-top: 8px; }
    .stat-change.up { color: #00ff88; }
    .stat-change.down { color: #ff6b6b; }
    
    /* Client List */
    .client-row { display: flex; align-items: center; gap: 16px; padding: 16px; background: #111; border: 1px solid #222; border-radius: 12px; margin-bottom: 12px; cursor: pointer; transition: all 0.2s; }
    .client-row:hover { border-color: #4169E1; transform: translateX(4px); }
    .client-avatar-lg { width: 48px; height: 48px; border-radius: 12px; background: linear-gradient(135deg, #4169E1, #00ff88); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 16px; }
    .client-details { flex: 1; }
    .client-name-lg { font-size: 16px; font-weight: 600; }
    .client-meta-lg { font-size: 13px; color: #666; margin-top: 2px; }
    .client-stats { display: flex; gap: 24px; }
    .client-stat { text-align: center; }
    .client-stat-value { font-size: 18px; font-weight: 700; }
    .client-stat-label { font-size: 11px; color: #666; }
    
    /* Scrollbar */
    ::-webkit-scrollbar { width: 8px; }
    ::-webkit-scrollbar-track { background: #111; }
    ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
    ::-webkit-scrollbar-thumb:hover { background: #444; }
    
    /* Exercise Library Styles */
    .exercise-card { background: #111; border: 1px solid #222; border-radius: 12px; padding: 16px; cursor: pointer; transition: all 0.2s; }
    .exercise-card:hover { border-color: #4169E1; transform: translateY(-2px); }
    .exercise-gif { width: 100%; height: 200px; background: #0a0a0a; border-radius: 8px; margin-bottom: 12px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
    .exercise-gif img { width: 100%; height: 100%; object-fit: cover; border-radius: 8px; }
    .exercise-name { font-size: 16px; font-weight: 600; margin-bottom: 8px; }
    .exercise-meta { display: flex; gap: 8px; margin-bottom: 8px; }
    .exercise-tag { font-size: 11px; padding: 4px 8px; border-radius: 12px; background: #333; color: #ccc; }
    .exercise-tag.bodypart { background: #4169E120; color: #4169E1; }
    .exercise-tag.equipment { background: #00ff8820; color: #00ff88; }
    .exercise-instructions { font-size: 13px; color: #888; line-height: 1.4; }
    
    /* Loading Animation */
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    
    /* Exercise Modal */
    .exercise-modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; align-items: center; justify-content: center; z-index: 1000; }
    .exercise-modal-content { background: #111; border-radius: 16px; padding: 24px; max-width: 600px; width: 90%; max-height: 80vh; overflow-y: auto; position: relative; }
    .exercise-modal-close { position: absolute; top: 16px; right: 16px; cursor: pointer; color: #666; }
    .exercise-modal-close:hover { color: #fff; }
    .exercise-modal-gif { width: 100%; height: 300px; background: #0a0a0a; border-radius: 12px; margin-bottom: 20px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
    .exercise-modal-gif img { width: 100%; height: 100%; object-fit: cover; border-radius: 12px; }
    .exercise-modal-name { font-size: 24px; font-weight: 700; margin-bottom: 12px; }
    .exercise-modal-meta { display: flex; gap: 12px; margin-bottom: 16px; }
    .exercise-modal-instructions { font-size: 14px; line-height: 1.6; color: #ccc; }
    
    /* Nutrition Styles */
    .nutrition-tab { padding: 10px 20px; background: #1a1a1a; border: 1px solid #333; border-radius: 8px; color: #888; font-size: 13px; font-weight: 500; cursor: pointer; transition: all 0.2s; }
    .nutrition-tab:hover { border-color: #4169E1; color: #fff; }
    .nutrition-tab.active { background: #4169E1; border-color: #4169E1; color: #fff; }
    .nutrition-content { display: block; }
    .nutrition-input { width: 100%; padding: 10px 14px; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; color: #fff; font-size: 14px; }
    .nutrition-input:focus { outline: none; border-color: #4169E1; }
    .input-group { margin-bottom: 14px; }
    .input-label { display: block; font-size: 11px; color: #666; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 6px; }
    
    .macro-slider { width: 100%; height: 6px; -webkit-appearance: none; background: #333; border-radius: 3px; outline: none; }
    .macro-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 18px; height: 18px; background: #4169E1; border-radius: 50%; cursor: pointer; }
    
    .macro-results { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; background: #0a0a0a; border-radius: 12px; padding: 16px; margin-top: 16px; }
    .macro-result-item { text-align: center; }
    .macro-result-value { font-size: 24px; font-weight: 700; }
    .macro-result-value.protein { color: #4169E1; }
    .macro-result-value.carbs { color: #ffcc00; }
    .macro-result-value.fats { color: #ff6b6b; }
    .macro-result-label { font-size: 11px; color: #666; text-transform: uppercase; margin-top: 4px; }
    
    .daily-totals-bar { display: flex; gap: 24px; background: #0a0a0a; border-radius: 10px; padding: 12px 16px; margin-bottom: 16px; }
    .daily-total { display: flex; align-items: center; gap: 6px; }
    .daily-total-label { font-size: 12px; color: #666; }
    .daily-total-value { font-size: 14px; font-weight: 600; }
    .daily-total-value.protein { color: #4169E1; }
    .daily-total-value.carbs { color: #ffcc00; }
    .daily-total-value.fats { color: #ff6b6b; }
    .daily-total-target { font-size: 12px; color: #444; }
    
    .meal-slot { background: #1a1a1a; border: 1px solid #222; border-radius: 12px; padding: 16px; margin-bottom: 12px; }
    .meal-slot-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
    .meal-slot-name { font-weight: 600; font-size: 14px; }
    .meal-slot-macros { font-size: 12px; color: #666; }
    .meal-food-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 12px; background: #111; border-radius: 8px; margin-bottom: 8px; }
    .meal-food-name { font-size: 13px; }
    .meal-food-macros { font-size: 11px; color: #888; }
    .meal-food-remove { color: #666; cursor: pointer; padding: 4px; }
    .meal-food-remove:hover { color: #ff6b6b; }
    
    .add-food-btn { width: 100%; padding: 10px; background: transparent; border: 1px dashed #333; border-radius: 8px; color: #666; font-size: 13px; cursor: pointer; transition: all 0.2s; }
    .add-food-btn:hover { border-color: #4169E1; color: #4169E1; }
    
    .plan-card { background: #111; border: 1px solid #222; border-radius: 12px; padding: 16px; cursor: pointer; transition: all 0.2s; }
    .plan-card:hover { border-color: #4169E1; transform: translateY(-2px); }
    .plan-header { display: flex; align-items: center; gap: 12px; margin-bottom: 12px; }
    .plan-avatar { width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, #4169E1, #00ff88); display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 14px; }
    .plan-client { font-weight: 600; font-size: 15px; }
    .plan-meta { font-size: 12px; color: #666; }
    .plan-macros { display: flex; justify-content: space-between; margin-bottom: 12px; }
    .plan-macro { text-align: center; }
    .plan-macro-value { font-size: 16px; font-weight: 600; }
    .plan-macro-value.protein { color: #4169E1; }
    .plan-macro-value.carbs { color: #ffcc00; }
    .plan-macro-value.fats { color: #ff6b6b; }
    .plan-macro-label { font-size: 10px; color: #666; }
    .plan-compliance { height: 4px; background: #222; border-radius: 2px; overflow: hidden; }
    .plan-compliance-bar { height: 100%; background: #00ff88; border-radius: 2px; }
    .plan-compliance-text { font-size: 11px; color: #666; margin-top: 8px; }
    
    .food-card { background: #1a1a1a; border: 1px solid #222; border-radius: 10px; padding: 12px; cursor: pointer; transition: all 0.2s; }
    .food-card:hover { border-color: #00ff88; }
    .food-card-name { font-size: 14px; font-weight: 500; margin-bottom: 6px; }
    .food-card-serving { font-size: 11px; color: #666; margin-bottom: 8px; }
    .food-card-macros { display: flex; gap: 8px; font-size: 11px; }
    .food-card-macro { padding: 2px 6px; background: #111; border-radius: 4px; }
    
    .ai-quick-btn { padding: 6px 12px; background: #1a1a1a; border: 1px solid #333; border-radius: 16px; color: #888; font-size: 12px; cursor: pointer; transition: all 0.2s; }
    .ai-quick-btn:hover { border-color: #00ff88; color: #00ff88; }
    
    .preset-btn { padding: 8px 12px; background: #1a1a1a; border: 1px solid #333; border-radius: 8px; color: #ccc; font-size: 12px; cursor: pointer; transition: all 0.2s; }
    .preset-btn:hover { border-color: #00ff88; background: #00ff8810; }
    
    /* Program Studio Styles */
    .studio-panel { background: #111; border-right: 1px solid #222; display: flex; flex-direction: column; height: 100%; }
    .studio-panel:last-child { border-right: none; }
    .studio-panel-header { padding: 12px 16px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center; flex-shrink: 0; }
    .studio-panel-title { font-size: 13px; font-weight: 600; color: #fff; }
    .studio-panel-count { font-size: 11px; color: #666; }
    
    .studio-exercises { width: 280px; flex-shrink: 0; }
    .studio-search { padding: 12px; border-bottom: 1px solid #222; display: flex; align-items: center; gap: 8px; background: #0a0a0a; }
    .studio-search input { flex: 1; background: transparent; border: none; color: #fff; font-size: 13px; outline: none; }
    .studio-search input::placeholder { color: #555; }
    .studio-filters { padding: 8px 12px; display: flex; gap: 8px; border-bottom: 1px solid #222; }
    .studio-filters select { flex: 1; padding: 6px 8px; background: #1a1a1a; border: 1px solid #333; border-radius: 6px; color: #ccc; font-size: 11px; cursor: pointer; }
    .studio-exercise-list { flex: 1; overflow-y: auto; padding: 8px; }
    
    .studio-exercise-item { padding: 10px 12px; background: #1a1a1a; border: 1px solid #222; border-radius: 8px; margin-bottom: 6px; cursor: grab; transition: all 0.2s; }
    .studio-exercise-item:hover { border-color: #4169E1; background: #1a1a2a; }
    .studio-exercise-item:active { cursor: grabbing; }
    .studio-exercise-item.dragging { opacity: 0.5; border-color: #4169E1; }
    .studio-exercise-name { font-size: 13px; font-weight: 500; margin-bottom: 4px; }
    .studio-exercise-meta { display: flex; gap: 6px; }
    .studio-exercise-tag { font-size: 10px; padding: 2px 6px; border-radius: 4px; background: #333; color: #888; }
    .studio-exercise-tag.bodypart { background: #4169E120; color: #4169E1; }
    .studio-exercise-tag.equipment { background: #00ff8820; color: #00ff88; }
    
    .studio-builder { flex: 1; display: flex; flex-direction: column; min-width: 0; }
    .program-title-input { background: transparent; border: none; color: #fff; font-size: 16px; font-weight: 600; width: 180px; outline: none; border-bottom: 1px solid transparent; }
    .program-title-input:focus { border-bottom-color: #4169E1; }
    .studio-select-sm { padding: 6px 10px; background: #1a1a1a; border: 1px solid #333; border-radius: 6px; color: #ccc; font-size: 12px; cursor: pointer; }
    .studio-actions { display: flex; gap: 6px; }
    
    .week-nav { display: flex; align-items: center; gap: 8px; padding: 10px 16px; border-bottom: 1px solid #222; background: #0a0a0a; flex-shrink: 0; }
    .week-nav-btn { width: 28px; height: 28px; border-radius: 6px; background: #1a1a1a; border: 1px solid #333; color: #888; cursor: pointer; display: flex; align-items: center; justify-content: center; }
    .week-nav-btn:hover { border-color: #4169E1; color: #fff; }
    .week-tabs { display: flex; gap: 4px; flex: 1; overflow-x: auto; }
    .week-tab { padding: 6px 14px; background: #1a1a1a; border: 1px solid #333; border-radius: 6px; color: #888; font-size: 12px; font-weight: 500; cursor: pointer; white-space: nowrap; transition: all 0.2s; }
    .week-tab:hover { border-color: #4169E1; color: #fff; }
    .week-tab.active { background: #4169E1; border-color: #4169E1; color: #fff; }
    .week-add-btn { padding: 6px 12px; background: transparent; border: 1px dashed #333; border-radius: 6px; color: #666; font-size: 12px; cursor: pointer; }
    .week-add-btn:hover { border-color: #00ff88; color: #00ff88; }
    
    .days-grid { display: grid; grid-template-columns: repeat(7, 1fr); flex: 1; overflow: hidden; }
    .day-column { border-right: 1px solid #222; display: flex; flex-direction: column; min-width: 0; }
    .day-column:last-child { border-right: none; }
    .day-header { padding: 10px 8px; border-bottom: 1px solid #222; background: #0a0a0a; text-align: center; flex-shrink: 0; }
    .day-name { display: block; font-size: 11px; font-weight: 600; color: #888; text-transform: uppercase; letter-spacing: 0.5px; }
    .day-focus { display: block; font-size: 12px; color: #4169E1; margin-top: 2px; outline: none; }
    .day-focus:focus { background: #1a1a1a; border-radius: 4px; padding: 2px 4px; }
    .day-exercises { flex: 1; padding: 8px; overflow-y: auto; min-height: 100px; }
    .day-exercises.drag-over { background: #4169E110; }
    .drop-zone-hint { font-size: 11px; color: #444; text-align: center; padding: 20px 8px; border: 1px dashed #333; border-radius: 6px; }
    
    .program-exercise { padding: 8px; background: #1a1a1a; border: 1px solid #333; border-radius: 6px; margin-bottom: 6px; cursor: grab; position: relative; }
    .program-exercise:hover { border-color: #4169E1; }
    .program-exercise-name { font-size: 11px; font-weight: 500; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .program-exercise-sets { display: flex; gap: 4px; flex-wrap: wrap; }
    .program-exercise-set { font-size: 10px; padding: 2px 6px; background: #333; border-radius: 4px; color: #888; }
    .program-exercise-remove { position: absolute; top: 4px; right: 4px; width: 16px; height: 16px; border-radius: 50%; background: #333; color: #666; font-size: 10px; cursor: pointer; display: none; align-items: center; justify-content: center; }
    .program-exercise:hover .program-exercise-remove { display: flex; }
    .program-exercise-remove:hover { background: #ff6b6b; color: #fff; }
    
    .studio-ai { width: 300px; flex-shrink: 0; display: flex; flex-direction: column; }
    .ai-icon-sm { width: 24px; height: 24px; border-radius: 6px; background: linear-gradient(135deg, #4169E1, #00ff88); display: flex; align-items: center; justify-content: center; }
    .ai-studio-chat { flex: 1; overflow-y: auto; padding: 12px; }
    .ai-studio-msg { margin-bottom: 12px; }
    .ai-studio-msg.assistant .ai-studio-msg-content { background: #1a1a1a; border-radius: 12px; padding: 12px; font-size: 13px; line-height: 1.5; }
    .ai-studio-msg.assistant ul { margin: 8px 0 0 16px; padding: 0; }
    .ai-studio-msg.assistant li { margin-bottom: 4px; color: #888; font-size: 12px; }
    .ai-studio-msg.user .ai-studio-msg-content { background: #4169E1; border-radius: 12px; padding: 10px 14px; font-size: 13px; margin-left: 20px; }
    .ai-studio-quick { display: flex; flex-wrap: wrap; gap: 6px; padding: 8px 12px; border-top: 1px solid #222; }
    .ai-quick-chip { padding: 5px 10px; background: #1a1a1a; border: 1px solid #333; border-radius: 14px; color: #888; font-size: 11px; cursor: pointer; transition: all 0.2s; }
    .ai-quick-chip:hover { border-color: #4169E1; color: #fff; }
    .ai-studio-input { display: flex; gap: 8px; padding: 12px; border-top: 1px solid #222; }
    .ai-studio-input textarea { flex: 1; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; padding: 10px; color: #fff; font-size: 13px; resize: none; font-family: inherit; }
    .ai-studio-input textarea:focus { outline: none; border-color: #4169E1; }
    .ai-studio-send { width: 40px; height: 40px; border-radius: 8px; background: linear-gradient(135deg, #4169E1, #00ff88); border: none; color: #fff; cursor: pointer; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
    .ai-studio-send:hover { transform: scale(1.05); }
    
    .program-stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; padding: 12px; border-top: 1px solid #222; background: #0a0a0a; }
    .program-stat { text-align: center; }
    .program-stat-value { display: block; font-size: 18px; font-weight: 700; color: #4169E1; }
    .program-stat-label { font-size: 10px; color: #666; text-transform: uppercase; }
    
    /* P&L Chart Styles */
    .chart-period-btns { display: flex; gap: 4px; }
    .period-btn { padding: 4px 10px; background: transparent; border: 1px solid #333; border-radius: 6px; color: #666; font-size: 11px; font-weight: 500; cursor: pointer; transition: all 0.2s; }
    .period-btn:hover { border-color: #4169E1; color: #fff; }
    .period-btn.active { background: #4169E1; border-color: #4169E1; color: #fff; }
    .chart-legend { display: flex; gap: 16px; justify-content: center; margin-top: 12px; }
    .legend-item { display: flex; align-items: center; gap: 6px; font-size: 11px; color: #888; }
    .legend-dot { width: 8px; height: 8px; border-radius: 50%; }
    
    /* Client Performance Styles */
    .client-perf-row { display: flex; align-items: center; gap: 12px; padding: 10px 0; border-bottom: 1px solid #222; }
    .client-perf-row:last-child { border-bottom: none; }
    .client-perf-avatar { width: 32px; height: 32px; border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 11px; font-weight: 600; flex-shrink: 0; }
    .client-perf-info { flex: 1; min-width: 0; }
    .client-perf-name { font-size: 13px; font-weight: 500; }
    .client-perf-meta { font-size: 11px; color: #666; }
    .client-perf-bar { width: 80px; height: 6px; background: #222; border-radius: 3px; overflow: hidden; }
    .client-perf-fill { height: 100%; background: #00ff88; border-radius: 3px; transition: width 0.3s; }
    .client-perf-score { font-size: 14px; font-weight: 600; color: #00ff88; width: 40px; text-align: right; }
  </style>

  <!-- Main Content -->
  <main class="main">
    <!-- Dashboard Page -->
    <div id="page-dashboard" class="page active">
      <header class="header">
        <h1 class="header-title">Dashboard</h1>
        <div class="header-actions">
          <button class="btn btn-secondary btn-sm">
            <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            Quick Add
          </button>
        </div>
      </header>
      
      <div class="content">
        <!-- Stats Row -->
        <div class="grid-4" style="margin-bottom: 16px;">
          <div class="stat-card">
            <div class="stat-value blue">12</div>
            <div class="stat-label">Active Clients</div>
            <div class="stat-change up">+2 this month</div>
          </div>
          <div class="stat-card">
            <div class="stat-value green">$8,450</div>
            <div class="stat-label">Revenue (Dec)</div>
            <div class="stat-change up">+12% vs Nov</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">$5,200</div>
            <div class="stat-label">Net Profit (Dec)</div>
            <div class="stat-change up">+18% vs Nov</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">94%</div>
            <div class="stat-label">Client Retention</div>
            <div class="stat-change up">+3%</div>
          </div>
        </div>
        
        <!-- P&L Chart and Schedule Row -->
        <div class="grid-2" style="margin-bottom: 16px;">
          <!-- P&L Chart -->
          <div class="card">
            <div class="card-header">
              <div class="card-title">Revenue & Profit</div>
              <div class="chart-period-btns">
                <button class="period-btn" onclick="updatePLChart('1m')">1M</button>
                <button class="period-btn active" onclick="updatePLChart('6m')">6M</button>
                <button class="period-btn" onclick="updatePLChart('1y')">1Y</button>
                <button class="period-btn" onclick="updatePLChart('5y')">5Y</button>
              </div>
            </div>
            <div style="height: 220px; position: relative;">
              <canvas id="plChart"></canvas>
            </div>
            <div class="chart-legend">
              <div class="legend-item"><span class="legend-dot" style="background:#4169E1;"></span> Revenue</div>
              <div class="legend-item"><span class="legend-dot" style="background:#00ff88;"></span> Profit</div>
              <div class="legend-item"><span class="legend-dot" style="background:#ff6b6b;"></span> Expenses</div>
            </div>
          </div>
          
          <!-- Today's Schedule -->
          <div class="card">
            <div class="card-header">
              <div class="card-title">Today's Schedule</div>
              <button class="btn btn-secondary btn-sm" onclick="showPage('calendar')">View All</button>
            </div>
            <div class="schedule-item">
              <div class="schedule-time">9:00 AM</div>
              <div class="schedule-info">
                <div class="schedule-title">Sarah Johnson - Upper Body</div>
                <div class="schedule-meta">In-Person • Downtown Gym</div>
              </div>
              <div class="schedule-avatar" style="background: #4169E1;">SJ</div>
            </div>
            <div class="schedule-item">
              <div class="schedule-time">10:30 AM</div>
              <div class="schedule-info">
                <div class="schedule-title">Mike Chen - Check-in Call</div>
                <div class="schedule-meta">Virtual • Zoom</div>
              </div>
              <div class="schedule-avatar" style="background: #00ff88; color: #000;">MC</div>
            </div>
            <div class="schedule-item">
              <div class="schedule-time">2:00 PM</div>
              <div class="schedule-info">
                <div class="schedule-title">Emma Wilson - Lower Body</div>
                <div class="schedule-meta">In-Person • Studio B</div>
              </div>
              <div class="schedule-avatar" style="background: #ff6b6b;">EW</div>
            </div>
            <div class="schedule-item">
              <div class="schedule-time">4:00 PM</div>
              <div class="schedule-info">
                <div class="schedule-title">David Park - Program Review</div>
                <div class="schedule-meta">Virtual • Google Meet</div>
              </div>
              <div class="schedule-avatar" style="background: #ffcc00; color: #000;">DP</div>
            </div>
          </div>
        </div>
        
        <!-- Bottom Row: Client Performance & AI -->
        <div class="grid-2">
          <!-- Client Performance -->
          <div class="card">
            <div class="card-header">
              <div class="card-title">Client Performance</div>
              <button class="btn btn-secondary btn-sm" onclick="showPage('clients')">View All</button>
            </div>
            <div class="client-perf-row">
              <div class="client-perf-avatar" style="background: #4169E1;">SJ</div>
              <div class="client-perf-info">
                <div class="client-perf-name">Sarah Johnson</div>
                <div class="client-perf-meta">4/4 workouts • 92% nutrition</div>
              </div>
              <div class="client-perf-bar"><div class="client-perf-fill" style="width:94%;"></div></div>
              <div class="client-perf-score">94%</div>
            </div>
            <div class="client-perf-row">
              <div class="client-perf-avatar" style="background: #00ff88; color:#000;">MC</div>
              <div class="client-perf-info">
                <div class="client-perf-name">Mike Chen</div>
                <div class="client-perf-meta">3/4 workouts • 85% nutrition</div>
              </div>
              <div class="client-perf-bar"><div class="client-perf-fill" style="width:88%; background:#ffcc00;"></div></div>
              <div class="client-perf-score" style="color:#ffcc00;">88%</div>
            </div>
            <div class="client-perf-row">
              <div class="client-perf-avatar" style="background: #ff6b6b;">EW</div>
              <div class="client-perf-info">
                <div class="client-perf-name">Emma Wilson</div>
                <div class="client-perf-meta">3/3 workouts • 78% nutrition</div>
              </div>
              <div class="client-perf-bar"><div class="client-perf-fill" style="width:82%;"></div></div>
              <div class="client-perf-score">82%</div>
            </div>
            <div class="client-perf-row">
              <div class="client-perf-avatar" style="background: #ffcc00; color:#000;">DP</div>
              <div class="client-perf-info">
                <div class="client-perf-name">David Park</div>
                <div class="client-perf-meta">5/5 workouts • 95% nutrition</div>
              </div>
              <div class="client-perf-bar"><div class="client-perf-fill" style="width:96%;"></div></div>
              <div class="client-perf-score">96%</div>
            </div>
          </div>
          
          <!-- AI Quick Actions -->
          <div class="ai-panel">
            <div class="ai-panel-header">
              <div class="ai-panel-icon">
                <svg width="22" height="22" viewBox="0 0 40 40" fill="none"><path d="M8 20h24M12 14v12M28 14v12M6 17h4v6H6zM30 17h4v6h-4z" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/><path d="M20 8l4 6h-8l4-6z" fill="#fff"/></svg>
              </div>
              <div>
                <div class="ai-panel-title">LiftWise AI</div>
                <div class="ai-panel-subtitle">Your programming assistant</div>
              </div>
            </div>
            <div class="ai-input-area">
              <textarea class="ai-textarea" placeholder="Tell me what you need...&#10;&#10;Examples:&#10;• Create a 4-week hypertrophy program for Sarah&#10;• Reschedule all of Mike's sessions to mornings&#10;• Generate a deload week for all clients"></textarea>
              <div class="ai-suggestions">
                <span class="ai-suggestion" onclick="setAIPrompt('Create a program')">Create program</span>
                <span class="ai-suggestion" onclick="setAIPrompt('Reschedule sessions')">Reschedule</span>
                <span class="ai-suggestion" onclick="setAIPrompt('Generate deload week')">Deload week</span>
                <span class="ai-suggestion" onclick="setAIPrompt('Review progress')">Review progress</span>
              </div>
              <div class="ai-actions">
                <button class="btn" style="flex:1;">
                  <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                  Run Command
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Calendar Page -->
    <div id="page-calendar" class="page">
      <header class="header">
        <h1 class="header-title">Calendar</h1>
        <div class="header-actions">
          <button class="btn">
            <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            New Session
          </button>
        </div>
      </header>
      
      <div class="content">
        <div class="calendar-container">
          <div class="calendar-main">
            <div class="calendar-header">
              <div class="calendar-nav">
                <button class="calendar-nav-btn" onclick="changeMonth(-1)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
                </button>
                <div class="calendar-month" id="calendar-month">December 2024</div>
                <button class="calendar-nav-btn" onclick="changeMonth(1)">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
                </button>
              </div>
              <div class="calendar-views">
                <button class="calendar-view-btn" onclick="setCalendarView('week')">Week</button>
                <button class="calendar-view-btn active" onclick="setCalendarView('month')">Month</button>
              </div>
            </div>
            
            <div class="calendar-grid">
              <div class="calendar-weekdays">
                <div class="calendar-weekday">Sun</div>
                <div class="calendar-weekday">Mon</div>
                <div class="calendar-weekday">Tue</div>
                <div class="calendar-weekday">Wed</div>
                <div class="calendar-weekday">Thu</div>
                <div class="calendar-weekday">Fri</div>
                <div class="calendar-weekday">Sat</div>
              </div>
              <div class="calendar-days" id="calendar-days">
                <!-- Generated by JS -->
              </div>
            </div>
          </div>
          
          <div class="calendar-sidebar">
            <!-- AI Command Panel -->
            <div class="ai-panel" style="flex: none; max-height: 280px;">
              <div class="ai-panel-header">
                <div class="ai-panel-icon">
                  <svg width="22" height="22" viewBox="0 0 40 40" fill="none"><path d="M8 20h24M12 14v12M28 14v12M6 17h4v6H6zM30 17h4v6h-4z" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/><path d="M20 8l4 6h-8l4-6z" fill="#fff"/></svg>
                </div>
                <div>
                  <div class="ai-panel-title">AI Scheduling</div>
                  <div class="ai-panel-subtitle">Bulk edit with natural language</div>
                </div>
              </div>
              <textarea class="ai-textarea" style="min-height: 80px;" placeholder="e.g., Move all of Sarah's sessions to 8am next week"></textarea>
              <div class="ai-actions">
                <button class="btn btn-sm" style="flex:1;">Apply Changes</button>
              </div>
            </div>
            
            <!-- Selected Day Schedule -->
            <div class="schedule-card" style="flex: 1;">
              <div class="card-title" style="margin-bottom: 16px;">December 22, 2024</div>
              <div class="schedule-item">
                <div class="schedule-time">9:00 AM</div>
                <div class="schedule-info">
                  <div class="schedule-title">Sarah Johnson</div>
                  <div class="schedule-meta">Upper Body • In-Person</div>
                </div>
              </div>
              <div class="schedule-item">
                <div class="schedule-time">10:30 AM</div>
                <div class="schedule-info">
                  <div class="schedule-title">Mike Chen</div>
                  <div class="schedule-meta">Check-in • Virtual</div>
                </div>
              </div>
              <div class="schedule-item">
                <div class="schedule-time">2:00 PM</div>
                <div class="schedule-info">
                  <div class="schedule-title">Emma Wilson</div>
                  <div class="schedule-meta">Lower Body • In-Person</div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Clients Page -->
    <div id="page-clients" class="page">
      <header class="header">
        <h1 class="header-title">Clients</h1>
        <div class="header-actions">
          <input type="text" placeholder="Search clients..." style="padding: 10px 16px; background: #1a1a1a; border: 1px solid #333; border-radius: 8px; color: #fff; width: 250px;">
          <button class="btn">
            <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            Add Client
          </button>
        </div>
      </header>
      
      <div class="content">
        <div class="client-row">
          <div class="client-avatar-lg">SJ</div>
          <div class="client-details">
            <div class="client-name-lg">Sarah Johnson</div>
            <div class="client-meta-lg">Hypertrophy • 3x/week • Started Oct 2024</div>
          </div>
          <div class="client-stats">
            <div class="client-stat">
              <div class="client-stat-value" style="color: #00ff88;">94%</div>
              <div class="client-stat-label">Compliance</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value">12</div>
              <div class="client-stat-label">Sessions</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value" style="color: #4169E1;">$600</div>
              <div class="client-stat-label">Monthly</div>
            </div>
          </div>
        </div>
        
        <div class="client-row">
          <div class="client-avatar-lg" style="background: linear-gradient(135deg, #00ff88, #4169E1);">MC</div>
          <div class="client-details">
            <div class="client-name-lg">Mike Chen</div>
            <div class="client-meta-lg">Strength • 4x/week • Started Aug 2024</div>
          </div>
          <div class="client-stats">
            <div class="client-stat">
              <div class="client-stat-value" style="color: #00ff88;">88%</div>
              <div class="client-stat-label">Compliance</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value">18</div>
              <div class="client-stat-label">Sessions</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value" style="color: #4169E1;">$800</div>
              <div class="client-stat-label">Monthly</div>
            </div>
          </div>
        </div>
        
        <div class="client-row">
          <div class="client-avatar-lg" style="background: linear-gradient(135deg, #ff6b6b, #ffcc00);">EW</div>
          <div class="client-details">
            <div class="client-name-lg">Emma Wilson</div>
            <div class="client-meta-lg">Fat Loss • 3x/week • Started Nov 2024</div>
          </div>
          <div class="client-stats">
            <div class="client-stat">
              <div class="client-stat-value" style="color: #ffcc00;">76%</div>
              <div class="client-stat-label">Compliance</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value">8</div>
              <div class="client-stat-label">Sessions</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value" style="color: #4169E1;">$450</div>
              <div class="client-stat-label">Monthly</div>
            </div>
          </div>
        </div>
        
        <div class="client-row">
          <div class="client-avatar-lg" style="background: linear-gradient(135deg, #ffcc00, #ff6b6b);">DP</div>
          <div class="client-details">
            <div class="client-name-lg">David Park</div>
            <div class="client-meta-lg">Athletic Performance • 5x/week • Started Jun 2024</div>
          </div>
          <div class="client-stats">
            <div class="client-stat">
              <div class="client-stat-value" style="color: #00ff88;">98%</div>
              <div class="client-stat-label">Compliance</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value">24</div>
              <div class="client-stat-label">Sessions</div>
            </div>
            <div class="client-stat">
              <div class="client-stat-value" style="color: #4169E1;">$1,200</div>
              <div class="client-stat-label">Monthly</div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- AI Coach Page -->
    <div id="page-ai-coach" class="page">
      <header class="header">
        <h1 class="header-title">AI Coach</h1>
        <div class="header-actions">
          <button class="btn btn-secondary btn-sm">View History</button>
        </div>
      </header>
      
      <div class="content">
        <div style="display: grid; grid-template-columns: 1fr 350px; gap: 24px; height: calc(100vh - 140px);">
          <!-- Main Chat Area -->
          <div class="card" style="display: flex; flex-direction: column; padding: 0; overflow: hidden;">
            <div style="padding: 16px; border-bottom: 1px solid #222; display: flex; align-items: center; gap: 12px;">
              <div class="ai-panel-icon">
                <svg width="22" height="22" viewBox="0 0 40 40" fill="none"><path d="M8 20h24M12 14v12M28 14v12M6 17h4v6H6zM30 17h4v6h-4z" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/><path d="M20 8l4 6h-8l4-6z" fill="#fff"/></svg>
              </div>
              <div>
                <div style="font-weight: 600;">LiftWise AI</div>
                <div style="font-size: 12px; color: #666;">Programming Assistant • GPT-4</div>
              </div>
            </div>
            
            <div style="flex: 1; overflow-y: auto; padding: 16px;" id="desktop-ai-messages">
              <!-- AI Welcome Message -->
              <div style="display: flex; gap: 12px; margin-bottom: 20px;">
                <div style="width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, #4169E1, #00ff88); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                  <svg width="22" height="22" viewBox="0 0 40 40" fill="none"><path d="M8 20h24M12 14v12M28 14v12M6 17h4v6H6zM30 17h4v6h-4z" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/><path d="M20 8l4 6h-8l4-6z" fill="#fff"/></svg>
                </div>
                <div style="background: #1a1a1a; border-radius: 12px; padding: 16px; max-width: 80%;">
                  <div style="font-size: 12px; color: #4169E1; margin-bottom: 8px;">LiftWise AI</div>
                  <div style="line-height: 1.6;">
                    Hey! I'm your AI programming assistant. I can help you with:
                    <ul style="margin: 12px 0 0 20px; color: #ccc;">
                      <li>Creating periodized training programs</li>
                      <li>Bulk scheduling and rescheduling sessions</li>
                      <li>Generating deload weeks</li>
                      <li>Analyzing client progress</li>
                      <li>Exercise substitutions and progressions</li>
                    </ul>
                  </div>
                </div>
              </div>
            </div>
            
            <div style="padding: 16px; border-top: 1px solid #222;">
              <div style="display: flex; gap: 12px;">
                <textarea id="desktop-ai-input" style="flex: 1; background: #0a0a0a; border: 1px solid #333; border-radius: 12px; padding: 14px; color: #fff; font-size: 14px; resize: none; height: 52px; font-family: inherit;" placeholder="Ask me anything about programming, scheduling, or client management..."></textarea>
                <button class="btn" onclick="sendDesktopAIMessage()">
                  <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                </button>
              </div>
            </div>
          </div>
          
          <!-- Quick Actions Sidebar -->
          <div style="display: flex; flex-direction: column; gap: 16px;">
            <div class="card">
              <div class="card-title" style="margin-bottom: 16px;">Quick Commands</div>
              <div style="display: flex; flex-direction: column; gap: 8px;">
                <button class="btn btn-secondary btn-sm" style="justify-content: flex-start;" onclick="setDesktopPrompt('Create a 4-week hypertrophy program for Sarah Johnson')">
                  <svg viewBox="0 0 24 24" style="width:16px;height:16px;"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                  Create Program
                </button>
                <button class="btn btn-secondary btn-sm" style="justify-content: flex-start;" onclick="setDesktopPrompt('Generate a deload week for all clients starting Monday')">
                  <svg viewBox="0 0 24 24" style="width:16px;height:16px;"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
                  Deload Week
                </button>
                <button class="btn btn-secondary btn-sm" style="justify-content: flex-start;" onclick="setDesktopPrompt('Reschedule all sessions for Mike Chen to morning slots')">
                  <svg viewBox="0 0 24 24" style="width:16px;height:16px;"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"/></svg>
                  Reschedule
                </button>
                <button class="btn btn-secondary btn-sm" style="justify-content: flex-start;" onclick="setDesktopPrompt('Analyze progress for Emma Wilson over the last 4 weeks')">
                  <svg viewBox="0 0 24 24" style="width:16px;height:16px;"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/></svg>
                  Analyze Progress
                </button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-title" style="margin-bottom: 16px;">Select Client</div>
              <select style="width: 100%; padding: 12px; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; color: #fff; font-size: 14px;">
                <option>All Clients</option>
                <option>Sarah Johnson</option>
                <option>Mike Chen</option>
                <option>Emma Wilson</option>
                <option>David Park</option>
              </select>
            </div>
            
            <div class="card" style="flex: 1;">
              <div class="card-title" style="margin-bottom: 16px;">Recent Actions</div>
              <div style="font-size: 13px; color: #666;">
                <div style="padding: 8px 0; border-bottom: 1px solid #222;">Created 4-week program for Sarah</div>
                <div style="padding: 8px 0; border-bottom: 1px solid #222;">Rescheduled Mike's Thursday session</div>
                <div style="padding: 8px 0;">Generated deload for David</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Placeholder pages -->
    <div id="page-messages" class="page">
      <header class="header"><h1 class="header-title">Messages</h1></header>
      <div class="content"><div class="card"><p style="color:#666;">Messages interface coming soon...</p></div></div>
    </div>
    
    <!-- Programs Repository Page -->
    <div id="page-programs" class="page">
      <header class="header">
        <h1 class="header-title">Programs</h1>
        <div class="header-actions">
          <button class="btn btn-secondary btn-sm">
            <svg viewBox="0 0 24 24"><path d="M3 17v2h6v-2H3zM3 5v2h10V5H3zm10 16v-2h8v-2h-8v-2h-2v6h2zM7 9v2H3v2h4v2h2V9H7zm14 4v-2H11v2h10zm-6-4h2V7h4V5h-4V3h-2v6z"/></svg>
            Filter
          </button>
          <button class="btn" onclick="showPage('studio')">
            <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            Create New
          </button>
        </div>
      </header>
      
      <div class="content">
        <!-- Program Stats -->
        <div class="grid-4" style="margin-bottom: 20px;">
          <div class="stat-card">
            <div class="stat-value blue">8</div>
            <div class="stat-label">Active Programs</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">15</div>
            <div class="stat-label">Templates</div>
          </div>
          <div class="stat-card">
            <div class="stat-value green">12</div>
            <div class="stat-label">Clients Assigned</div>
          </div>
          <div class="stat-card">
            <div class="stat-value">94%</div>
            <div class="stat-label">Avg Completion</div>
          </div>
        </div>
        
        <!-- Tabs -->
        <div style="display: flex; gap: 8px; margin-bottom: 16px;">
          <button class="nutrition-tab active" onclick="showProgramsTab('active')">Active Programs</button>
          <button class="nutrition-tab" onclick="showProgramsTab('templates')">Templates</button>
          <button class="nutrition-tab" onclick="showProgramsTab('archived')">Archived</button>
        </div>
        
        <!-- Active Programs Grid -->
        <div id="programs-active" class="grid-3">
          <div class="plan-card" onclick="editProgram('ppl')">
            <div class="plan-header">
              <div class="plan-avatar">SJ</div>
              <div>
                <div class="plan-client">Push/Pull/Legs</div>
                <div class="plan-meta">Sarah Johnson • Week 3 of 8</div>
              </div>
            </div>
            <div style="display:flex;gap:8px;margin-bottom:12px;">
              <span class="exercise-tag bodypart">Hypertrophy</span>
              <span class="exercise-tag equipment">4 days/week</span>
            </div>
            <div class="plan-compliance"><div class="plan-compliance-bar" style="width:85%;"></div></div>
            <div class="plan-compliance-text">85% compliance this week</div>
          </div>
          
          <div class="plan-card" onclick="editProgram('strength')">
            <div class="plan-header">
              <div class="plan-avatar" style="background:linear-gradient(135deg,#00ff88,#4169E1);">MC</div>
              <div>
                <div class="plan-client">Strength Builder</div>
                <div class="plan-meta">Mike Chen • Week 6 of 12</div>
              </div>
            </div>
            <div style="display:flex;gap:8px;margin-bottom:12px;">
              <span class="exercise-tag bodypart">Strength</span>
              <span class="exercise-tag equipment">5 days/week</span>
            </div>
            <div class="plan-compliance"><div class="plan-compliance-bar" style="width:92%;"></div></div>
            <div class="plan-compliance-text">92% compliance this week</div>
          </div>
          
          <div class="plan-card" onclick="editProgram('cut')">
            <div class="plan-header">
              <div class="plan-avatar" style="background:linear-gradient(135deg,#ff6b6b,#ffcc00);">EW</div>
              <div>
                <div class="plan-client">Summer Cut</div>
                <div class="plan-meta">Emma Wilson • Week 2 of 6</div>
              </div>
            </div>
            <div style="display:flex;gap:8px;margin-bottom:12px;">
              <span class="exercise-tag bodypart">Fat Loss</span>
              <span class="exercise-tag equipment">6 days/week</span>
            </div>
            <div class="plan-compliance"><div class="plan-compliance-bar" style="width:78%;"></div></div>
            <div class="plan-compliance-text">78% compliance this week</div>
          </div>
          
          <div class="plan-card" onclick="editProgram('beginner')">
            <div class="plan-header">
              <div class="plan-avatar" style="background:linear-gradient(135deg,#4169E1,#00ff88);">DP</div>
              <div>
                <div class="plan-client">Beginner Foundations</div>
                <div class="plan-meta">David Park • Week 1 of 4</div>
              </div>
            </div>
            <div style="display:flex;gap:8px;margin-bottom:12px;">
              <span class="exercise-tag bodypart">General</span>
              <span class="exercise-tag equipment">3 days/week</span>
            </div>
            <div class="plan-compliance"><div class="plan-compliance-bar" style="width:100%;"></div></div>
            <div class="plan-compliance-text">100% compliance this week</div>
          </div>
        </div>
        
        <!-- Templates (hidden by default) -->
        <div id="programs-templates" class="grid-3" style="display:none;">
          <div class="plan-card" style="border-style:dashed;cursor:pointer;" onclick="showPage('studio')">
            <div style="text-align:center;padding:20px 0;">
              <svg width="40" height="40" viewBox="0 0 24 24" fill="#4169E1"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
              <div style="margin-top:8px;color:#888;">Create New Template</div>
            </div>
          </div>
          
          <div class="plan-card" onclick="useTemplate('ppl')">
            <div class="plan-header">
              <div class="plan-avatar" style="background:#333;">📋</div>
              <div>
                <div class="plan-client">PPL Classic</div>
                <div class="plan-meta">Push/Pull/Legs • 6 days</div>
              </div>
            </div>
            <div style="font-size:12px;color:#888;margin-top:8px;">Used 24 times • Last updated Nov 15</div>
          </div>
          
          <div class="plan-card" onclick="useTemplate('upper-lower')">
            <div class="plan-header">
              <div class="plan-avatar" style="background:#333;">📋</div>
              <div>
                <div class="plan-client">Upper/Lower Split</div>
                <div class="plan-meta">4 day split • Intermediate</div>
              </div>
            </div>
            <div style="font-size:12px;color:#888;margin-top:8px;">Used 18 times • Last updated Dec 1</div>
          </div>
          
          <div class="plan-card" onclick="useTemplate('fullbody')">
            <div class="plan-header">
              <div class="plan-avatar" style="background:#333;">📋</div>
              <div>
                <div class="plan-client">Full Body 3x</div>
                <div class="plan-meta">3 day full body • Beginner</div>
              </div>
            </div>
            <div style="font-size:12px;color:#888;margin-top:8px;">Used 31 times • Last updated Oct 20</div>
          </div>
        </div>
        
        <!-- Archived (hidden by default) -->
        <div id="programs-archived" style="display:none;">
          <div class="card" style="text-align:center;padding:40px;">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="#333"><path d="M20.54 5.23l-1.39-1.68C18.88 3.21 18.47 3 18 3H6c-.47 0-.88.21-1.16.55L3.46 5.23C3.17 5.57 3 6.02 3 6.5V19c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V6.5c0-.48-.17-.93-.46-1.27zM12 17.5L6.5 12H10v-2h4v2h3.5L12 17.5zM5.12 5l.81-1h12l.94 1H5.12z"/></svg>
            <div style="color:#666;margin-top:12px;">No archived programs</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Program Studio Page -->
    <div id="page-studio" class="page">
      <header class="header">
        <h1 class="header-title">Program Studio</h1>
        <div class="header-actions">
          <button class="btn btn-secondary btn-sm" onclick="showPage('programs')">
            <svg viewBox="0 0 24 24"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
            My Programs
          </button>
          <button class="btn" onclick="openNewProgramModal()">
            <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            New Program
          </button>
        </div>
      </header>
      
      <div class="content" style="padding: 0; display: flex; height: calc(100vh - 60px);">
        <!-- Left Panel: Exercise Library -->
        <div class="studio-panel studio-exercises">
          <div class="studio-panel-header">
            <span class="studio-panel-title">Exercise Library</span>
            <span class="studio-panel-count" id="exercise-count">0 exercises</span>
          </div>
          <div class="studio-search">
            <svg width="14" height="14" viewBox="0 0 24 24" fill="#666"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
            <input type="text" id="studio-exercise-search" placeholder="Search exercises..." oninput="filterStudioExercises()">
          </div>
          <div class="studio-filters">
            <select id="studio-bodypart" onchange="filterStudioExercises()">
              <option value="">All Body Parts</option>
              <option value="chest">Chest</option>
              <option value="back">Back</option>
              <option value="shoulders">Shoulders</option>
              <option value="upper arms">Arms</option>
              <option value="upper legs">Legs</option>
              <option value="waist">Core</option>
            </select>
            <select id="studio-equipment" onchange="filterStudioExercises()">
              <option value="">All Equipment</option>
              <option value="barbell">Barbell</option>
              <option value="dumbbell">Dumbbell</option>
              <option value="cable">Cable</option>
              <option value="machine">Machine</option>
              <option value="body weight">Bodyweight</option>
            </select>
          </div>
          <div class="studio-exercise-list" id="studio-exercise-list">
            <!-- Exercises loaded here -->
          </div>
        </div>
        
        <!-- Center Panel: Program Builder -->
        <div class="studio-panel studio-builder">
          <div class="studio-panel-header">
            <div style="display:flex;align-items:center;gap:12px;">
              <input type="text" id="program-title" class="program-title-input" value="New Program" placeholder="Program Name">
              <select id="program-client" class="studio-select-sm">
                <option value="">Select Client</option>
                <option value="sarah">Sarah Johnson</option>
                <option value="mike">Mike Chen</option>
                <option value="emma">Emma Wilson</option>
                <option value="david">David Park</option>
              </select>
            </div>
            <div class="studio-actions">
              <button class="btn btn-secondary btn-sm" onclick="undoProgramChange()">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></svg>
              </button>
              <button class="btn btn-secondary btn-sm" onclick="redoProgramChange()">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor"><path d="M18.4 10.6C16.55 8.99 14.15 8 11.5 8c-4.65 0-8.58 3.03-9.96 7.22L3.9 16c1.05-3.19 4.05-5.5 7.6-5.5 1.95 0 3.73.72 5.12 1.88L13 16h9V7l-3.6 3.6z"/></svg>
              </button>
              <button class="btn btn-sm" onclick="saveProgramStudio()">Save Program</button>
            </div>
          </div>
          
          <!-- Week Navigation -->
          <div class="week-nav">
            <button class="week-nav-btn" onclick="changeWeek(-1)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z"/></svg>
            </button>
            <div class="week-tabs" id="week-tabs">
              <button class="week-tab active" onclick="selectWeek(1)">Week 1</button>
              <button class="week-tab" onclick="selectWeek(2)">Week 2</button>
              <button class="week-tab" onclick="selectWeek(3)">Week 3</button>
              <button class="week-tab" onclick="selectWeek(4)">Week 4</button>
            </div>
            <button class="week-nav-btn" onclick="changeWeek(1)">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"/></svg>
            </button>
            <button class="week-add-btn" onclick="addWeek()">+ Add Week</button>
          </div>
          
          <!-- Days Grid -->
          <div class="days-grid" id="days-grid">
            <div class="day-column" data-day="1">
              <div class="day-header">
                <span class="day-name">Monday</span>
                <span class="day-focus" contenteditable="true">Push</span>
              </div>
              <div class="day-exercises" id="day-1-exercises" ondrop="dropExercise(event, 1)" ondragover="allowDrop(event)">
                <div class="drop-zone-hint">Drag exercises here</div>
              </div>
            </div>
            <div class="day-column" data-day="2">
              <div class="day-header">
                <span class="day-name">Tuesday</span>
                <span class="day-focus" contenteditable="true">Pull</span>
              </div>
              <div class="day-exercises" id="day-2-exercises" ondrop="dropExercise(event, 2)" ondragover="allowDrop(event)">
                <div class="drop-zone-hint">Drag exercises here</div>
              </div>
            </div>
            <div class="day-column" data-day="3">
              <div class="day-header">
                <span class="day-name">Wednesday</span>
                <span class="day-focus" contenteditable="true">Rest</span>
              </div>
              <div class="day-exercises" id="day-3-exercises" ondrop="dropExercise(event, 3)" ondragover="allowDrop(event)">
                <div class="drop-zone-hint">Rest Day</div>
              </div>
            </div>
            <div class="day-column" data-day="4">
              <div class="day-header">
                <span class="day-name">Thursday</span>
                <span class="day-focus" contenteditable="true">Legs</span>
              </div>
              <div class="day-exercises" id="day-4-exercises" ondrop="dropExercise(event, 4)" ondragover="allowDrop(event)">
                <div class="drop-zone-hint">Drag exercises here</div>
              </div>
            </div>
            <div class="day-column" data-day="5">
              <div class="day-header">
                <span class="day-name">Friday</span>
                <span class="day-focus" contenteditable="true">Upper</span>
              </div>
              <div class="day-exercises" id="day-5-exercises" ondrop="dropExercise(event, 5)" ondragover="allowDrop(event)">
                <div class="drop-zone-hint">Drag exercises here</div>
              </div>
            </div>
            <div class="day-column" data-day="6">
              <div class="day-header">
                <span class="day-name">Saturday</span>
                <span class="day-focus" contenteditable="true">Cardio</span>
              </div>
              <div class="day-exercises" id="day-6-exercises" ondrop="dropExercise(event, 6)" ondragover="allowDrop(event)">
                <div class="drop-zone-hint">Drag exercises here</div>
              </div>
            </div>
            <div class="day-column" data-day="7">
              <div class="day-header">
                <span class="day-name">Sunday</span>
                <span class="day-focus" contenteditable="true">Rest</span>
              </div>
              <div class="day-exercises" id="day-7-exercises" ondrop="dropExercise(event, 7)" ondragover="allowDrop(event)">
                <div class="drop-zone-hint">Rest Day</div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Right Panel: AI Assistant -->
        <div class="studio-panel studio-ai">
          <div class="studio-panel-header">
            <div style="display:flex;align-items:center;gap:8px;">
              <div class="ai-icon-sm">
                <svg width="16" height="16" viewBox="0 0 40 40" fill="none"><path d="M8 20h24M12 14v12M28 14v12" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/></svg>
              </div>
              <span class="studio-panel-title">AI Assistant</span>
            </div>
          </div>
          
          <div class="ai-studio-chat" id="ai-studio-chat">
            <div class="ai-studio-msg assistant">
              <div class="ai-studio-msg-content">
                I can help you build this program! Try:
                <ul>
                  <li>"Generate a 4-week hypertrophy program"</li>
                  <li>"Add chest exercises to Monday"</li>
                  <li>"Swap bench press for dumbbell press"</li>
                  <li>"Make week 4 a deload week"</li>
                  <li>"Add progressive overload"</li>
                </ul>
              </div>
            </div>
          </div>
          
          <div class="ai-studio-quick">
            <button class="ai-quick-chip" onclick="aiStudioCommand('generate')">Generate Program</button>
            <button class="ai-quick-chip" onclick="aiStudioCommand('deload')">Add Deload</button>
            <button class="ai-quick-chip" onclick="aiStudioCommand('progress')">Add Progression</button>
            <button class="ai-quick-chip" onclick="aiStudioCommand('balance')">Balance Volume</button>
          </div>
          
          <div class="ai-studio-input">
            <textarea id="ai-studio-input" placeholder="Ask AI to help build your program..." rows="2"></textarea>
            <button class="ai-studio-send" onclick="sendAIStudioMessage()">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
            </button>
          </div>
          
          <!-- Program Stats -->
          <div class="program-stats">
            <div class="program-stat">
              <span class="program-stat-value" id="stat-exercises">0</span>
              <span class="program-stat-label">Exercises</span>
            </div>
            <div class="program-stat">
              <span class="program-stat-value" id="stat-sets">0</span>
              <span class="program-stat-label">Total Sets</span>
            </div>
            <div class="program-stat">
              <span class="program-stat-value" id="stat-volume">0</span>
              <span class="program-stat-label">Weekly Vol</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Nutrition Planning Page -->
    <div id="page-nutrition" class="page">
      <header class="header">
        <h1 class="header-title">Nutrition Planning</h1>
        <div class="header-actions">
          <button class="btn btn-secondary btn-sm" onclick="showNutritionTab('plans')">
            <svg viewBox="0 0 24 24"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
            Saved Plans
          </button>
          <button class="btn" onclick="showNutritionTab('create')">
            <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
            New Plan
          </button>
        </div>
      </header>
      
      <div class="content">
        <!-- Tab Navigation -->
        <div style="display: flex; gap: 8px; margin-bottom: 16px;">
          <button class="nutrition-tab active" id="tab-ai" onclick="showNutritionTab('ai')">AI Generator</button>
          <button class="nutrition-tab" id="tab-create" onclick="showNutritionTab('create')">Custom Builder</button>
          <button class="nutrition-tab" id="tab-plans" onclick="showNutritionTab('plans')">Client Plans</button>
          <button class="nutrition-tab" id="tab-foods" onclick="showNutritionTab('foods')">Food Database</button>
        </div>
        
        <!-- AI Generator Tab -->
        <div id="nutrition-ai" class="nutrition-content">
          <div style="display: grid; grid-template-columns: 1fr 400px; gap: 16px; height: calc(100vh - 200px);">
            <!-- AI Chat -->
            <div class="card" style="display: flex; flex-direction: column; padding: 0; overflow: hidden;">
              <div style="padding: 16px; border-bottom: 1px solid #222; display: flex; align-items: center; gap: 12px;">
                <div style="width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, #00ff88, #4169E1); display: flex; align-items: center; justify-content: center;">
                  <svg width="22" height="22" viewBox="0 0 24 24" fill="#fff"><path d="M18.06 22.99h1.66c.84 0 1.53-.64 1.63-1.46L23 5.05l-5 2v16.94h.06zM1 21.99h15.03V3.95l-5-2-10 2v18.04z"/></svg>
                </div>
                <div>
                  <div style="font-weight: 600;">Nutrition AI</div>
                  <div style="font-size: 12px; color: #666;">Meal Plan Generator • GPT-4</div>
                </div>
              </div>
              
              <div style="flex: 1; overflow-y: auto; padding: 16px;" id="nutrition-ai-messages">
                <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                  <div style="width: 36px; height: 36px; border-radius: 10px; background: linear-gradient(135deg, #00ff88, #4169E1); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff"><path d="M18.06 22.99h1.66c.84 0 1.53-.64 1.63-1.46L23 5.05l-5 2v16.94h.06zM1 21.99h15.03V3.95l-5-2-10 2v18.04z"/></svg>
                  </div>
                  <div style="background: #1a1a1a; border-radius: 12px; padding: 14px; max-width: 85%;">
                    <div style="font-size: 11px; color: #00ff88; margin-bottom: 6px;">Nutrition AI</div>
                    <div style="line-height: 1.5; font-size: 14px;">
                      Hey! I can help you create personalized nutrition plans. Tell me about your client:
                      <ul style="margin: 10px 0 0 16px; color: #ccc; font-size: 13px;">
                        <li>Their goals (fat loss, muscle gain, maintenance)</li>
                        <li>Current stats (weight, body fat %, activity level)</li>
                        <li>Dietary preferences or restrictions</li>
                        <li>Number of meals per day</li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              
              <!-- Quick Prompts -->
              <div style="padding: 8px 16px; border-top: 1px solid #222; display: flex; gap: 8px; flex-wrap: wrap;">
                <button class="ai-quick-btn" onclick="useNutritionPrompt('fat-loss')">Fat Loss Plan</button>
                <button class="ai-quick-btn" onclick="useNutritionPrompt('muscle-gain')">Muscle Gain</button>
                <button class="ai-quick-btn" onclick="useNutritionPrompt('maintenance')">Maintenance</button>
                <button class="ai-quick-btn" onclick="useNutritionPrompt('keto')">Keto</button>
                <button class="ai-quick-btn" onclick="useNutritionPrompt('vegan')">Vegan</button>
              </div>
              
              <div style="padding: 12px 16px; border-top: 1px solid #222;">
                <div style="display: flex; gap: 12px;">
                  <textarea id="nutrition-ai-input" style="flex: 1; background: #0a0a0a; border: 1px solid #333; border-radius: 10px; padding: 12px; color: #fff; font-size: 14px; resize: none; height: 48px; font-family: inherit;" placeholder="Describe the nutrition plan you need..."></textarea>
                  <button class="btn" onclick="sendNutritionAIMessage()">
                    <svg viewBox="0 0 24 24"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
                  </button>
                </div>
              </div>
            </div>
            
            <!-- Generated Plan Preview -->
            <div class="card" style="display: flex; flex-direction: column; overflow: hidden;">
              <div class="card-title" style="margin-bottom: 12px;">Generated Plan Preview</div>
              <div id="generated-plan-preview" style="flex: 1; overflow-y: auto;">
                <div style="text-align: center; padding: 40px 20px; color: #666;">
                  <svg width="48" height="48" viewBox="0 0 24 24" fill="#333" style="margin-bottom: 12px;"><path d="M18.06 22.99h1.66c.84 0 1.53-.64 1.63-1.46L23 5.05l-5 2v16.94h.06zM1 21.99h15.03V3.95l-5-2-10 2v18.04z"/></svg>
                  <p>Your AI-generated meal plan will appear here</p>
                </div>
              </div>
            </div>
          </div>
        </div>
        
        <!-- Custom Builder Tab -->
        <div id="nutrition-create" class="nutrition-content" style="display: none;">
          <div style="display: grid; grid-template-columns: 350px 1fr; gap: 16px; height: calc(100vh - 200px);">
            <!-- Macro Calculator -->
            <div class="card" style="overflow-y: auto;">
              <div class="card-title" style="margin-bottom: 16px;">Macro Calculator</div>
              
              <div class="input-group">
                <label class="input-label">Client</label>
                <select id="nutrition-client" class="nutrition-input" onchange="loadClientStats()">
                  <option value="">Select Client</option>
                  <option value="sarah">Sarah Johnson</option>
                  <option value="mike">Mike Chen</option>
                  <option value="emma">Emma Wilson</option>
                  <option value="david">David Park</option>
                </select>
              </div>
              
              <div class="input-group">
                <label class="input-label">Goal</label>
                <select id="nutrition-goal" class="nutrition-input" onchange="calculateMacros()">
                  <option value="fat-loss">Fat Loss (-500 cal)</option>
                  <option value="aggressive-loss">Aggressive Fat Loss (-750 cal)</option>
                  <option value="maintenance">Maintenance</option>
                  <option value="lean-gain">Lean Muscle Gain (+250 cal)</option>
                  <option value="bulk">Bulk (+500 cal)</option>
                </select>
              </div>
              
              <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px;">
                <div class="input-group">
                  <label class="input-label">Weight (lbs)</label>
                  <input type="number" id="client-weight" class="nutrition-input" value="145" onchange="calculateMacros()">
                </div>
                <div class="input-group">
                  <label class="input-label">Body Fat %</label>
                  <input type="number" id="client-bodyfat" class="nutrition-input" value="22" onchange="calculateMacros()">
                </div>
              </div>
              
              <div class="input-group">
                <label class="input-label">Activity Level</label>
                <select id="activity-level" class="nutrition-input" onchange="calculateMacros()">
                  <option value="1.2">Sedentary (desk job)</option>
                  <option value="1.375">Light (1-3 days/week)</option>
                  <option value="1.55" selected>Moderate (3-5 days/week)</option>
                  <option value="1.725">Active (6-7 days/week)</option>
                  <option value="1.9">Very Active (2x/day)</option>
                </select>
              </div>
              
              <div class="input-group">
                <label class="input-label">Protein (g per lb of bodyweight)</label>
                <input type="range" id="protein-ratio" min="0.7" max="1.2" step="0.1" value="1.0" class="macro-slider" onchange="calculateMacros()">
                <div style="display: flex; justify-content: space-between; font-size: 11px; color: #666;">
                  <span>0.7g</span>
                  <span id="protein-ratio-display">1.0g</span>
                  <span>1.2g</span>
                </div>
              </div>
              
              <div class="input-group">
                <label class="input-label">Fat % of Calories</label>
                <input type="range" id="fat-ratio" min="20" max="40" step="5" value="25" class="macro-slider" onchange="calculateMacros()">
                <div style="display: flex; justify-content: space-between; font-size: 11px; color: #666;">
                  <span>20%</span>
                  <span id="fat-ratio-display">25%</span>
                  <span>40%</span>
                </div>
              </div>
              
              <!-- Calculated Macros Display -->
              <div class="macro-results" id="macro-results">
                <div class="macro-result-item">
                  <div class="macro-result-value" id="calc-calories">1,850</div>
                  <div class="macro-result-label">Calories</div>
                </div>
                <div class="macro-result-item">
                  <div class="macro-result-value protein" id="calc-protein">145g</div>
                  <div class="macro-result-label">Protein</div>
                </div>
                <div class="macro-result-item">
                  <div class="macro-result-value carbs" id="calc-carbs">185g</div>
                  <div class="macro-result-label">Carbs</div>
                </div>
                <div class="macro-result-item">
                  <div class="macro-result-value fats" id="calc-fats">52g</div>
                  <div class="macro-result-label">Fats</div>
                </div>
              </div>
              
              <button class="btn" style="width: 100%; margin-top: 12px;" onclick="applyMacrosToBuilder()">
                Apply to Meal Plan
              </button>
            </div>
            
            <!-- Meal Plan Builder -->
            <div class="card" style="display: flex; flex-direction: column; overflow: hidden;">
              <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                <div class="card-title">Meal Plan Builder</div>
                <div style="display: flex; gap: 8px;">
                  <button class="btn btn-secondary btn-sm" onclick="addMealSlot()">+ Add Meal</button>
                  <button class="btn btn-sm" onclick="saveMealPlan()">Save Plan</button>
                </div>
              </div>
              
              <!-- Daily Totals Bar -->
              <div class="daily-totals-bar">
                <div class="daily-total">
                  <span class="daily-total-label">Calories:</span>
                  <span class="daily-total-value" id="daily-calories">0</span>
                  <span class="daily-total-target">/ <span id="target-calories">1,850</span></span>
                </div>
                <div class="daily-total">
                  <span class="daily-total-label">Protein:</span>
                  <span class="daily-total-value protein" id="daily-protein">0g</span>
                  <span class="daily-total-target">/ <span id="target-protein">145g</span></span>
                </div>
                <div class="daily-total">
                  <span class="daily-total-label">Carbs:</span>
                  <span class="daily-total-value carbs" id="daily-carbs">0g</span>
                  <span class="daily-total-target">/ <span id="target-carbs">185g</span></span>
                </div>
                <div class="daily-total">
                  <span class="daily-total-label">Fats:</span>
                  <span class="daily-total-value fats" id="daily-fats">0g</span>
                  <span class="daily-total-target">/ <span id="target-fats">52g</span></span>
                </div>
              </div>
              
              <!-- Meals Container -->
              <div id="meals-container" style="flex: 1; overflow-y: auto; padding-right: 8px;">
                <!-- Meals will be added here -->
              </div>
            </div>
          </div>
        </div>
        
        <!-- Client Plans Tab -->
        <div id="nutrition-plans" class="nutrition-content" style="display: none;">
          <div class="grid-3" style="gap: 16px;">
            <div class="plan-card" onclick="viewPlan('sarah')">
              <div class="plan-header">
                <div class="plan-avatar">SJ</div>
                <div>
                  <div class="plan-client">Sarah Johnson</div>
                  <div class="plan-meta">Fat Loss • Updated 2 days ago</div>
                </div>
              </div>
              <div class="plan-macros">
                <div class="plan-macro"><span class="plan-macro-value">1,650</span><span class="plan-macro-label">cal</span></div>
                <div class="plan-macro"><span class="plan-macro-value protein">145g</span><span class="plan-macro-label">P</span></div>
                <div class="plan-macro"><span class="plan-macro-value carbs">140g</span><span class="plan-macro-label">C</span></div>
                <div class="plan-macro"><span class="plan-macro-value fats">55g</span><span class="plan-macro-label">F</span></div>
              </div>
              <div class="plan-compliance">
                <div class="plan-compliance-bar" style="width: 85%;"></div>
              </div>
              <div class="plan-compliance-text">85% compliance this week</div>
            </div>
            
            <div class="plan-card" onclick="viewPlan('mike')">
              <div class="plan-header">
                <div class="plan-avatar" style="background: linear-gradient(135deg, #00ff88, #4169E1);">MC</div>
                <div>
                  <div class="plan-client">Mike Chen</div>
                  <div class="plan-meta">Muscle Gain • Updated 5 days ago</div>
                </div>
              </div>
              <div class="plan-macros">
                <div class="plan-macro"><span class="plan-macro-value">2,800</span><span class="plan-macro-label">cal</span></div>
                <div class="plan-macro"><span class="plan-macro-value protein">200g</span><span class="plan-macro-label">P</span></div>
                <div class="plan-macro"><span class="plan-macro-value carbs">300g</span><span class="plan-macro-label">C</span></div>
                <div class="plan-macro"><span class="plan-macro-value fats">85g</span><span class="plan-macro-label">F</span></div>
              </div>
              <div class="plan-compliance">
                <div class="plan-compliance-bar" style="width: 72%; background: #ffcc00;"></div>
              </div>
              <div class="plan-compliance-text">72% compliance this week</div>
            </div>
            
            <div class="plan-card" onclick="viewPlan('emma')">
              <div class="plan-header">
                <div class="plan-avatar" style="background: linear-gradient(135deg, #ff6b6b, #ffcc00);">EW</div>
                <div>
                  <div class="plan-client">Emma Wilson</div>
                  <div class="plan-meta">Fat Loss • Updated today</div>
                </div>
              </div>
              <div class="plan-macros">
                <div class="plan-macro"><span class="plan-macro-value">1,500</span><span class="plan-macro-label">cal</span></div>
                <div class="plan-macro"><span class="plan-macro-value protein">130g</span><span class="plan-macro-label">P</span></div>
                <div class="plan-macro"><span class="plan-macro-value carbs">120g</span><span class="plan-macro-label">C</span></div>
                <div class="plan-macro"><span class="plan-macro-value fats">50g</span><span class="plan-macro-label">F</span></div>
              </div>
              <div class="plan-compliance">
                <div class="plan-compliance-bar" style="width: 91%;"></div>
              </div>
              <div class="plan-compliance-text">91% compliance this week</div>
            </div>
            
            <div class="plan-card" onclick="viewPlan('david')">
              <div class="plan-header">
                <div class="plan-avatar" style="background: linear-gradient(135deg, #ffcc00, #ff6b6b);">DP</div>
                <div>
                  <div class="plan-client">David Park</div>
                  <div class="plan-meta">Performance • Updated 1 week ago</div>
                </div>
              </div>
              <div class="plan-macros">
                <div class="plan-macro"><span class="plan-macro-value">3,200</span><span class="plan-macro-label">cal</span></div>
                <div class="plan-macro"><span class="plan-macro-value protein">220g</span><span class="plan-macro-label">P</span></div>
                <div class="plan-macro"><span class="plan-macro-value carbs">380g</span><span class="plan-macro-label">C</span></div>
                <div class="plan-macro"><span class="plan-macro-value fats">90g</span><span class="plan-macro-label">F</span></div>
              </div>
              <div class="plan-compliance">
                <div class="plan-compliance-bar" style="width: 88%;"></div>
              </div>
              <div class="plan-compliance-text">88% compliance this week</div>
            </div>
          </div>
        </div>
        
        <!-- Food Database Tab -->
        <div id="nutrition-foods" class="nutrition-content" style="display: none;">
          <div style="display: grid; grid-template-columns: 1fr 350px; gap: 16px; height: calc(100vh - 200px);">
            <!-- Food Search -->
            <div class="card" style="display: flex; flex-direction: column; overflow: hidden;">
              <div style="display: flex; gap: 12px; margin-bottom: 16px;">
                <div style="flex: 1; position: relative;">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="#666" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                  <input type="text" id="food-search-input" placeholder="Search foods..." style="padding: 10px 16px 10px 40px; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; color: #fff; width: 100%; font-size: 14px;" oninput="searchFoods()">
                </div>
                <select id="food-category-filter" class="nutrition-input" style="width: 180px;" onchange="filterFoods()">
                  <option value="">All Categories</option>
                  <option value="protein">Proteins</option>
                  <option value="carbs">Carbohydrates</option>
                  <option value="fats">Fats</option>
                  <option value="vegetables">Vegetables</option>
                  <option value="fruits">Fruits</option>
                  <option value="dairy">Dairy</option>
                </select>
              </div>
              
              <div id="food-database-status" style="font-size: 12px; color: #666; margin-bottom: 12px;"></div>
              
              <div id="food-database-grid" style="flex: 1; overflow-y: auto; display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; align-content: start;">
                <!-- Foods will be loaded here -->
              </div>
            </div>
            
            <!-- Food Details / Add Custom -->
            <div class="card">
              <div class="card-title" style="margin-bottom: 16px;">Add Custom Food</div>
              
              <div class="input-group">
                <label class="input-label">Food Name</label>
                <input type="text" id="custom-food-name" class="nutrition-input" placeholder="e.g., Grilled Chicken Breast">
              </div>
              
              <div class="input-group">
                <label class="input-label">Serving Size</label>
                <div style="display: flex; gap: 8px;">
                  <input type="number" id="custom-serving-amount" class="nutrition-input" placeholder="100" style="flex: 1;">
                  <select id="custom-serving-unit" class="nutrition-input" style="width: 100px;">
                    <option value="g">grams</option>
                    <option value="oz">oz</option>
                    <option value="cup">cup</option>
                    <option value="tbsp">tbsp</option>
                    <option value="piece">piece</option>
                  </select>
                </div>
              </div>
              
              <div class="input-group">
                <label class="input-label">Calories</label>
                <input type="number" id="custom-calories" class="nutrition-input" placeholder="165">
              </div>
              
              <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 12px;">
                <div class="input-group">
                  <label class="input-label">Protein (g)</label>
                  <input type="number" id="custom-protein" class="nutrition-input" placeholder="31">
                </div>
                <div class="input-group">
                  <label class="input-label">Carbs (g)</label>
                  <input type="number" id="custom-carbs" class="nutrition-input" placeholder="0">
                </div>
                <div class="input-group">
                  <label class="input-label">Fat (g)</label>
                  <input type="number" id="custom-fat" class="nutrition-input" placeholder="3.6">
                </div>
              </div>
              
              <div class="input-group">
                <label class="input-label">Category</label>
                <select id="custom-category" class="nutrition-input">
                  <option value="protein">Protein</option>
                  <option value="carbs">Carbohydrate</option>
                  <option value="fats">Fat</option>
                  <option value="vegetables">Vegetable</option>
                  <option value="fruits">Fruit</option>
                  <option value="dairy">Dairy</option>
                </select>
              </div>
              
              <button class="btn" style="width: 100%; margin-top: 12px;" onclick="addCustomFood()">
                <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                Add to Database
              </button>
              
              <div style="margin-top: 24px; padding-top: 16px; border-top: 1px solid #222;">
                <div class="card-title" style="margin-bottom: 12px;">Quick Add Presets</div>
                <div style="display: flex; flex-wrap: wrap; gap: 8px;">
                  <button class="preset-btn" onclick="addPresetFood('chicken')">🍗 Chicken</button>
                  <button class="preset-btn" onclick="addPresetFood('rice')">🍚 Rice</button>
                  <button class="preset-btn" onclick="addPresetFood('eggs')">🥚 Eggs</button>
                  <button class="preset-btn" onclick="addPresetFood('salmon')">🐟 Salmon</button>
                  <button class="preset-btn" onclick="addPresetFood('oats')">🥣 Oats</button>
                  <button class="preset-btn" onclick="addPresetFood('broccoli')">🥦 Broccoli</button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Exercise Library Page -->
    <div id="page-exercises" class="page">
      <header class="header">
        <h1 class="header-title">Exercise Library</h1>
        <div class="header-actions">
          <button class="btn btn-secondary btn-sm" onclick="refreshExerciseLibrary()">
            <svg viewBox="0 0 24 24"><path d="M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"/></svg>
            Refresh
          </button>
        </div>
      </header>
      
      <div class="content">
        <!-- Search and Filters -->
        <div class="grid-3" style="margin-bottom: 16px;">
          <div class="card" style="padding: 16px;">
            <div class="card-title" style="margin-bottom: 12px;">Search</div>
            <div style="position: relative;">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="#666" style="position:absolute;left:12px;top:50%;transform:translateY(-50%);"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
              <input type="text" id="exercise-search-input" placeholder="Search exercises..." style="padding: 10px 16px 10px 40px; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; color: #fff; width: 100%; font-size: 14px;" oninput="searchExercises()">
            </div>
          </div>
          
          <div class="card" style="padding: 16px;">
            <div class="card-title" style="margin-bottom: 12px;">Body Part</div>
            <select id="bodypart-filter" style="padding: 10px 16px; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; color: #fff; width: 100%; font-size: 14px;" onchange="filterExercises()">
              <option value="">All Body Parts</option>
              <option value="back">Back</option>
              <option value="cardio">Cardio</option>
              <option value="chest">Chest</option>
              <option value="lower arms">Lower Arms</option>
              <option value="lower legs">Lower Legs</option>
              <option value="neck">Neck</option>
              <option value="shoulders">Shoulders</option>
              <option value="upper arms">Upper Arms</option>
              <option value="upper legs">Upper Legs</option>
              <option value="waist">Waist</option>
            </select>
          </div>
          
          <div class="card" style="padding: 16px;">
            <div class="card-title" style="margin-bottom: 12px;">Equipment</div>
            <select id="equipment-filter" style="padding: 10px 16px; background: #0a0a0a; border: 1px solid #333; border-radius: 8px; color: #fff; width: 100%; font-size: 14px;" onchange="filterExercises()">
              <option value="">All Equipment</option>
              <option value="barbell">Barbell</option>
              <option value="dumbbell">Dumbbell</option>
              <option value="cable">Cable</option>
              <option value="body weight">Body Weight</option>
              <option value="machine">Machine</option>
              <option value="kettlebell">Kettlebell</option>
              <option value="resistance band">Resistance Band</option>
            </select>
          </div>
        </div>
        
        <!-- API Status -->
        <div id="exercise-api-status" style="text-align: center; margin-bottom: 16px; font-size: 12px; color: #666;"></div>
        
        <!-- Exercise Grid -->
        <div id="exercise-grid" class="grid-3" style="gap: 16px;">
          <!-- Exercises will be loaded here -->
        </div>
        
        <!-- Loading State -->
        <div id="exercise-loading" style="text-align: center; padding: 40px; color: #666;">
          <div style="margin-bottom: 12px;">Loading exercises...</div>
          <div style="width: 40px; height: 40px; border: 3px solid #333; border-top: 3px solid #4169E1; border-radius: 50%; animation: spin 1s linear infinite; margin: 0 auto;"></div>
        </div>
      </div>
    </div>
    
    <div id="page-revenue" class="page">
      <header class="header"><h1 class="header-title">Revenue</h1></header>
      <div class="content"><div class="card"><p style="color:#666;">Revenue dashboard coming soon...</p></div></div>
    </div>
    <div id="page-settings" class="page">
      <header class="header"><h1 class="header-title">Settings</h1></header>
      <div class="content"><div class="card"><p style="color:#666;">Settings coming soon...</p></div></div>
    </div>
  </main>
</div>

<script>
// ==================== PAGE NAVIGATION ====================
function showPage(pageId) {
  const currentPage = document.querySelector('.page.active');
  const newPage = document.getElementById('page-' + pageId);
  
  if (currentPage && newPage && currentPage !== newPage) {
    currentPage.style.opacity = '0';
    currentPage.style.transform = 'translateY(-10px)';
    
    setTimeout(() => {
      document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
      newPage.classList.add('active');
      newPage.style.opacity = '0';
      newPage.style.transform = 'translateY(10px)';
      requestAnimationFrame(() => {
        newPage.style.transition = 'opacity 0.2s ease, transform 0.2s ease';
        newPage.style.opacity = '1';
        newPage.style.transform = 'translateY(0)';
      });
    }, 150);
  } else if (newPage) {
    document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
    newPage.classList.add('active');
  }
  
  // Update nav
  document.querySelectorAll('.nav-item').forEach(item => item.classList.remove('active'));
  event?.target?.closest('.nav-item')?.classList.add('active');
  
  // Generate calendar if needed
  if (pageId === 'calendar') {
    generateCalendar();
  }
}

// ==================== CALENDAR ====================
let currentMonth = 11; // December (0-indexed)
let currentYear = 2024;

const sessions = [
  { date: '2024-12-22', time: '9:00 AM', client: 'Sarah J.', type: 'session' },
  { date: '2024-12-22', time: '10:30 AM', client: 'Mike C.', type: 'checkin' },
  { date: '2024-12-22', time: '2:00 PM', client: 'Emma W.', type: 'session' },
  { date: '2024-12-23', time: '8:00 AM', client: 'David P.', type: 'session' },
  { date: '2024-12-23', time: '11:00 AM', client: 'Sarah J.', type: 'workout' },
  { date: '2024-12-24', time: '9:00 AM', client: 'Mike C.', type: 'session' },
  { date: '2024-12-26', time: '10:00 AM', client: 'Emma W.', type: 'checkin' },
  { date: '2024-12-27', time: '9:00 AM', client: 'Sarah J.', type: 'session' },
  { date: '2024-12-27', time: '2:00 PM', client: 'David P.', type: 'session' },
  { date: '2024-12-28', time: '8:00 AM', client: 'Mike C.', type: 'workout' },
  { date: '2024-12-30', time: '9:00 AM', client: 'Emma W.', type: 'session' },
];

function generateCalendar() {
  const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
  document.getElementById('calendar-month').textContent = `${monthNames[currentMonth]} ${currentYear}`;
  
  const firstDay = new Date(currentYear, currentMonth, 1).getDay();
  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
  const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();
  
  const container = document.getElementById('calendar-days');
  container.innerHTML = '';
  
  const today = new Date();
  const todayStr = `${today.getFullYear()}-${String(today.getMonth() + 1).padStart(2, '0')}-${String(today.getDate()).padStart(2, '0')}`;
  
  // Previous month days
  for (let i = firstDay - 1; i >= 0; i--) {
    const day = daysInPrevMonth - i;
    container.innerHTML += `<div class="calendar-day other-month"><div class="calendar-day-num">${day}</div></div>`;
  }
  
  // Current month days
  for (let day = 1; day <= daysInMonth; day++) {
    const dateStr = `${currentYear}-${String(currentMonth + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
    const isToday = dateStr === todayStr;
    const dayEvents = sessions.filter(s => s.date === dateStr);
    
    let eventsHtml = '';
    dayEvents.slice(0, 3).forEach(e => {
      eventsHtml += `<div class="calendar-event ${e.type}">${e.time} ${e.client}</div>`;
    });
    if (dayEvents.length > 3) {
      eventsHtml += `<div style="font-size:10px;color:#666;">+${dayEvents.length - 3} more</div>`;
    }
    
    container.innerHTML += `
      <div class="calendar-day ${isToday ? 'today' : ''}">
        <div class="calendar-day-num">${day}</div>
        ${eventsHtml}
      </div>
    `;
  }
  
  // Next month days
  const totalCells = container.children.length;
  const remaining = 42 - totalCells;
  for (let day = 1; day <= remaining; day++) {
    container.innerHTML += `<div class="calendar-day other-month"><div class="calendar-day-num">${day}</div></div>`;
  }
}

function changeMonth(delta) {
  currentMonth += delta;
  if (currentMonth > 11) { currentMonth = 0; currentYear++; }
  if (currentMonth < 0) { currentMonth = 11; currentYear--; }
  generateCalendar();
}

function setCalendarView(view) {
  document.querySelectorAll('.calendar-view-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
}

// ==================== AI FUNCTIONS ====================
function setAIPrompt(text) {
  document.querySelector('.ai-textarea').value = text;
}

function setDesktopPrompt(text) {
  document.getElementById('desktop-ai-input').value = text;
}

function sendDesktopAIMessage() {
  const input = document.getElementById('desktop-ai-input');
  const message = input.value.trim();
  if (!message) return;
  
  const container = document.getElementById('desktop-ai-messages');
  
  // Add user message
  container.innerHTML += `
    <div style="display: flex; gap: 12px; margin-bottom: 20px; justify-content: flex-end;">
      <div style="background: #4169E1; border-radius: 12px; padding: 16px; max-width: 80%;">
        <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-bottom: 8px;">You</div>
        <div style="line-height: 1.6;">${message}</div>
      </div>
      <div style="width: 40px; height: 40px; border-radius: 10px; background: #333; display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
        <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
      </div>
    </div>
  `;
  
  // Add AI response (simulated)
  setTimeout(() => {
    container.innerHTML += `
      <div style="display: flex; gap: 12px; margin-bottom: 20px;">
        <div style="width: 40px; height: 40px; border-radius: 10px; background: linear-gradient(135deg, #4169E1, #00ff88); display: flex; align-items: center; justify-content: center; flex-shrink: 0;">
          <svg width="22" height="22" viewBox="0 0 40 40" fill="none"><path d="M8 20h24M12 14v12M28 14v12M6 17h4v6H6zM30 17h4v6h-4z" stroke="#fff" stroke-width="2.5" stroke-linecap="round"/><path d="M20 8l4 6h-8l4-6z" fill="#fff"/></svg>
        </div>
        <div style="background: #1a1a1a; border-radius: 12px; padding: 16px; max-width: 80%;">
          <div style="font-size: 12px; color: #4169E1; margin-bottom: 8px;">LiftWise AI</div>
          <div style="line-height: 1.6;">I'll help you with that! Processing your request...</div>
        </div>
      </div>
    `;
    container.scrollTop = container.scrollHeight;
  }, 500);
  
  input.value = '';
  container.scrollTop = container.scrollHeight;
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  generateCalendar();
  loadExerciseLibrary();
  initPLChart();
});

// ==================== P&L CHART ====================
let plChart = null;
const plData = {
  '1m': {
    labels: ['Week 1', 'Week 2', 'Week 3', 'Week 4'],
    revenue: [2100, 2400, 1950, 2000],
    profit: [1400, 1600, 1200, 1000],
    expenses: [700, 800, 750, 1000]
  },
  '6m': {
    labels: ['Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    revenue: [6200, 6800, 7100, 7500, 7800, 8450],
    profit: [3800, 4200, 4400, 4600, 4800, 5200],
    expenses: [2400, 2600, 2700, 2900, 3000, 3250]
  },
  '1y': {
    labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
    revenue: [4500, 4800, 5200, 5100, 5600, 5900, 6200, 6800, 7100, 7500, 7800, 8450],
    profit: [2700, 2900, 3200, 3000, 3400, 3600, 3800, 4200, 4400, 4600, 4800, 5200],
    expenses: [1800, 1900, 2000, 2100, 2200, 2300, 2400, 2600, 2700, 2900, 3000, 3250]
  },
  '5y': {
    labels: ['2020', '2021', '2022', '2023', '2024'],
    revenue: [32000, 48000, 62000, 78000, 92000],
    profit: [18000, 28000, 38000, 48000, 58000],
    expenses: [14000, 20000, 24000, 30000, 34000]
  }
};

function initPLChart() {
  const ctx = document.getElementById('plChart');
  if (!ctx) return;
  
  plChart = new Chart(ctx, {
    type: 'line',
    data: {
      labels: plData['6m'].labels,
      datasets: [
        {
          label: 'Revenue',
          data: plData['6m'].revenue,
          borderColor: '#4169E1',
          backgroundColor: 'rgba(65, 105, 225, 0.1)',
          fill: true,
          tension: 0.4,
          pointRadius: 3,
          pointBackgroundColor: '#4169E1'
        },
        {
          label: 'Profit',
          data: plData['6m'].profit,
          borderColor: '#00ff88',
          backgroundColor: 'rgba(0, 255, 136, 0.1)',
          fill: true,
          tension: 0.4,
          pointRadius: 3,
          pointBackgroundColor: '#00ff88'
        },
        {
          label: 'Expenses',
          data: plData['6m'].expenses,
          borderColor: '#ff6b6b',
          backgroundColor: 'rgba(255, 107, 107, 0.05)',
          fill: true,
          tension: 0.4,
          pointRadius: 3,
          pointBackgroundColor: '#ff6b6b'
        }
      ]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { display: false },
        tooltip: {
          backgroundColor: '#1a1a1a',
          titleColor: '#fff',
          bodyColor: '#ccc',
          borderColor: '#333',
          borderWidth: 1,
          padding: 10,
          callbacks: {
            label: function(context) {
              return context.dataset.label + ': $' + context.raw.toLocaleString();
            }
          }
        }
      },
      scales: {
        x: {
          grid: { color: '#222', drawBorder: false },
          ticks: { color: '#666', font: { size: 10 } }
        },
        y: {
          grid: { color: '#222', drawBorder: false },
          ticks: {
            color: '#666',
            font: { size: 10 },
            callback: function(value) { return '$' + (value / 1000) + 'k'; }
          }
        }
      },
      interaction: { intersect: false, mode: 'index' }
    }
  });
}

function updatePLChart(period) {
  document.querySelectorAll('.period-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  
  if (plChart && plData[period]) {
    plChart.data.labels = plData[period].labels;
    plChart.data.datasets[0].data = plData[period].revenue;
    plChart.data.datasets[1].data = plData[period].profit;
    plChart.data.datasets[2].data = plData[period].expenses;
    plChart.update();
  }
}

// ==================== EXERCISE LIBRARY ====================
let allExercises = [];
let filteredExercises = [];

async function loadExerciseLibrary() {
  const statusEl = document.getElementById('exercise-api-status');
  const loadingEl = document.getElementById('exercise-loading');
  const gridEl = document.getElementById('exercise-grid');
  
  try {
    statusEl.textContent = 'Loading exercises from ExerciseDB API...';
    loadingEl.style.display = 'block';
    gridEl.style.display = 'none';
    
    // Fetch exercises from ExerciseDB API
    const response = await fetch('https://exercisedb.p.rapidapi.com/exercises?limit=100', {
      method: 'GET',
      headers: {
        'X-RapidAPI-Key': 'DEMO_KEY', // In production, use a real API key
        'X-RapidAPI-Host': 'exercisedb.p.rapidapi.com'
      }
    });
    
    if (!response.ok) {
      throw new Error('API request failed');
    }
    
    const exercises = await response.json();
    allExercises = exercises;
    filteredExercises = exercises;
    
    statusEl.textContent = `Loaded ${exercises.length} exercises from ExerciseDB`;
    statusEl.style.color = '#00ff88';
    
    renderExercises();
    
  } catch (error) {
    console.log('API failed, using demo data');
    // Fallback to demo data when API fails
    allExercises = getDemoExercises();
    filteredExercises = allExercises;
    
    statusEl.textContent = 'Using demo exercise data (API key required for full library)';
    statusEl.style.color = '#ffcc00';
    
    renderExercises();
  }
  
  loadingEl.style.display = 'none';
  gridEl.style.display = 'grid';
}

function getDemoExercises() {
  return [
    {
      id: '0001',
      name: 'Barbell Bench Press',
      bodyPart: 'chest',
      equipment: 'barbell',
      gifUrl: 'https://v2.exercisedb.io/image/0001',
      instructions: [
        'Lie on a flat bench with your feet firmly planted on the ground.',
        'Grip the barbell with hands slightly wider than shoulder-width apart.',
        'Lower the bar to your chest with control.',
        'Press the bar back up to the starting position.'
      ]
    },
    {
      id: '0002',
      name: 'Dumbbell Bicep Curls',
      bodyPart: 'upper arms',
      equipment: 'dumbbell',
      gifUrl: 'https://v2.exercisedb.io/image/0002',
      instructions: [
        'Stand with feet shoulder-width apart, holding dumbbells at your sides.',
        'Keep your elbows close to your torso.',
        'Curl the weights up towards your shoulders.',
        'Lower the weights back down with control.'
      ]
    },
    {
      id: '0003',
      name: 'Barbell Squats',
      bodyPart: 'upper legs',
      equipment: 'barbell',
      gifUrl: 'https://v2.exercisedb.io/image/0003',
      instructions: [
        'Position the barbell on your upper back.',
        'Stand with feet shoulder-width apart.',
        'Lower your body by bending at the hips and knees.',
        'Return to the starting position by driving through your heels.'
      ]
    },
    {
      id: '0004',
      name: 'Pull-ups',
      bodyPart: 'back',
      equipment: 'body weight',
      gifUrl: 'https://v2.exercisedb.io/image/0004',
      instructions: [
        'Hang from a pull-up bar with palms facing away.',
        'Pull your body up until your chin clears the bar.',
        'Lower yourself back down with control.',
        'Repeat for desired repetitions.'
      ]
    },
    {
      id: '0005',
      name: 'Dumbbell Shoulder Press',
      bodyPart: 'shoulders',
      equipment: 'dumbbell',
      gifUrl: 'https://v2.exercisedb.io/image/0005',
      instructions: [
        'Sit on a bench with back support, holding dumbbells at shoulder height.',
        'Press the weights overhead until arms are fully extended.',
        'Lower the weights back to shoulder height.',
        'Repeat for desired repetitions.'
      ]
    },
    {
      id: '0006',
      name: 'Deadlifts',
      bodyPart: 'back',
      equipment: 'barbell',
      gifUrl: 'https://v2.exercisedb.io/image/0006',
      instructions: [
        'Stand with feet hip-width apart, barbell over mid-foot.',
        'Bend at hips and knees to grip the bar.',
        'Keep your back straight and chest up.',
        'Drive through heels to lift the bar, extending hips and knees.'
      ]
    },
    {
      id: '0007',
      name: 'Plank',
      bodyPart: 'waist',
      equipment: 'body weight',
      gifUrl: 'https://v2.exercisedb.io/image/0007',
      instructions: [
        'Start in a push-up position.',
        'Lower onto your forearms.',
        'Keep your body in a straight line from head to heels.',
        'Hold the position for the desired time.'
      ]
    },
    {
      id: '0008',
      name: 'Cable Lat Pulldown',
      bodyPart: 'back',
      equipment: 'cable',
      gifUrl: 'https://v2.exercisedb.io/image/0008',
      instructions: [
        'Sit at a lat pulldown machine with thighs secured.',
        'Grip the bar with hands wider than shoulder-width.',
        'Pull the bar down to your upper chest.',
        'Slowly return the bar to the starting position.'
      ]
    },
    {
      id: '0009',
      name: 'Leg Press',
      bodyPart: 'upper legs',
      equipment: 'machine',
      gifUrl: 'https://v2.exercisedb.io/image/0009',
      instructions: [
        'Sit on the leg press machine with back against the pad.',
        'Place feet on the platform shoulder-width apart.',
        'Lower the weight by bending your knees.',
        'Press the weight back up to the starting position.'
      ]
    },
    {
      id: '0010',
      name: 'Kettlebell Swings',
      bodyPart: 'waist',
      equipment: 'kettlebell',
      gifUrl: 'https://v2.exercisedb.io/image/0010',
      instructions: [
        'Stand with feet wider than shoulder-width, holding a kettlebell.',
        'Hinge at the hips and swing the kettlebell between your legs.',
        'Drive your hips forward to swing the kettlebell to chest height.',
        'Let the kettlebell swing back down and repeat.'
      ]
    }
  ];
}

function renderExercises() {
  const gridEl = document.getElementById('exercise-grid');
  
  if (filteredExercises.length === 0) {
    gridEl.innerHTML = '<div style="grid-column: 1/-1; text-align: center; padding: 40px; color: #666;">No exercises found matching your criteria.</div>';
    return;
  }
  
  gridEl.innerHTML = filteredExercises.map(exercise => `
    <div class="exercise-card" onclick="showExerciseModal('${exercise.id}')">
      <div class="exercise-gif">
        <img src="${exercise.gifUrl}" alt="${exercise.name}" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgdmlld0JveD0iMCAwIDIwMCAyMDAiIGZpbGw9Im5vbmUiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+CjxyZWN0IHdpZHRoPSIyMDAiIGhlaWdodD0iMjAwIiBmaWxsPSIjMTExIi8+CjxwYXRoIGQ9Ik0xMDAgNTBMMTUwIDEwMEgxMDBWMTUwSDUwVjEwMEgxMDBWNTBaIiBmaWxsPSIjNDQ0Ii8+Cjx0ZXh0IHg9IjEwMCIgeT0iMTgwIiB0ZXh0LWFuY2hvcj0ibWlkZGxlIiBmaWxsPSIjNjY2IiBmb250LXNpemU9IjEyIj5FeGVyY2lzZTwvdGV4dD4KPC9zdmc+'" loading="lazy">
      </div>
      <div class="exercise-name">${exercise.name}</div>
      <div class="exercise-meta">
        <span class="exercise-tag bodypart">${exercise.bodyPart}</span>
        <span class="exercise-tag equipment">${exercise.equipment}</span>
      </div>
      <div class="exercise-instructions">${exercise.instructions ? exercise.instructions[0] : 'Click to view details'}</div>
    </div>
  `).join('');
}

function searchExercises() {
  const searchTerm = document.getElementById('exercise-search-input').value.toLowerCase();
  const bodyPartFilter = document.getElementById('bodypart-filter').value;
  const equipmentFilter = document.getElementById('equipment-filter').value;
  
  filteredExercises = allExercises.filter(exercise => {
    const matchesSearch = exercise.name.toLowerCase().includes(searchTerm);
    const matchesBodyPart = !bodyPartFilter || exercise.bodyPart === bodyPartFilter;
    const matchesEquipment = !equipmentFilter || exercise.equipment === equipmentFilter;
    
    return matchesSearch && matchesBodyPart && matchesEquipment;
  });
  
  renderExercises();
}

function filterExercises() {
  searchExercises(); // Reuse the same filtering logic
}

function refreshExerciseLibrary() {
  loadExerciseLibrary();
}

function showExerciseModal(exerciseId) {
  const exercise = allExercises.find(ex => ex.id === exerciseId);
  if (!exercise) return;
  
  // Create modal if it doesn't exist
  let modal = document.getElementById('exercise-detail-modal');
  if (!modal) {
    modal = document.createElement('div');
    modal.id = 'exercise-detail-modal';
    modal.className = 'exercise-modal';
    modal.innerHTML = `
      <div class="exercise-modal-content">
        <div class="exercise-modal-close" onclick="closeExerciseModal()">
          <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor">
            <path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/>
          </svg>
        </div>
        <div class="exercise-modal-gif">
          <img id="modal-exercise-gif" src="" alt="">
        </div>
        <div class="exercise-modal-name" id="modal-exercise-name"></div>
        <div class="exercise-modal-meta" id="modal-exercise-meta"></div>
        <div class="exercise-modal-instructions" id="modal-exercise-instructions"></div>
        <button class="btn" style="margin-top: 20px;" onclick="addExerciseToProgram('${exerciseId}')">
          <svg viewBox="0 0 24 24"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
          Add to Program
        </button>
      </div>
    `;
    document.body.appendChild(modal);
  }
  
  // Populate modal content
  document.getElementById('modal-exercise-gif').src = exercise.gifUrl;
  document.getElementById('modal-exercise-name').textContent = exercise.name;
  document.getElementById('modal-exercise-meta').innerHTML = `
    <span class="exercise-tag bodypart">${exercise.bodyPart}</span>
    <span class="exercise-tag equipment">${exercise.equipment}</span>
  `;
  document.getElementById('modal-exercise-instructions').innerHTML = exercise.instructions 
    ? exercise.instructions.map(instruction => `<p style="margin-bottom: 8px;">• ${instruction}</p>`).join('')
    : '<p>No instructions available.</p>';
  
  modal.style.display = 'flex';
}

function closeExerciseModal() {
  const modal = document.getElementById('exercise-detail-modal');
  if (modal) {
    modal.style.display = 'none';
  }
}

function addExerciseToProgram(exerciseId) {
  const exercise = allExercises.find(ex => ex.id === exerciseId);
  alert(`Added "${exercise.name}" to program! (This would integrate with your program builder)`);
  closeExerciseModal();
}

// ==================== NUTRITION PLANNING ====================
let mealPlan = { meals: [], targetMacros: { calories: 1850, protein: 145, carbs: 185, fats: 52 } };
let foodDatabase = [];

function showNutritionTab(tabId) {
  document.querySelectorAll('.nutrition-tab').forEach(t => t.classList.remove('active'));
  document.querySelectorAll('.nutrition-content').forEach(c => c.style.display = 'none');
  
  document.getElementById('tab-' + tabId)?.classList.add('active');
  document.getElementById('nutrition-' + tabId).style.display = 'block';
  
  if (tabId === 'foods') loadFoodDatabase();
  if (tabId === 'create') initMealBuilder();
}

function calculateMacros() {
  const weight = parseFloat(document.getElementById('client-weight').value) || 145;
  const bodyfat = parseFloat(document.getElementById('client-bodyfat').value) || 22;
  const activity = parseFloat(document.getElementById('activity-level').value) || 1.55;
  const goal = document.getElementById('nutrition-goal').value;
  const proteinRatio = parseFloat(document.getElementById('protein-ratio').value) || 1.0;
  const fatRatio = parseFloat(document.getElementById('fat-ratio').value) || 25;
  
  document.getElementById('protein-ratio-display').textContent = proteinRatio + 'g';
  document.getElementById('fat-ratio-display').textContent = fatRatio + '%';
  
  const leanMass = weight * (1 - bodyfat / 100);
  const bmr = 370 + (21.6 * leanMass * 0.453592);
  let tdee = bmr * activity;
  
  const adjustments = { 'aggressive-loss': -750, 'fat-loss': -500, 'maintenance': 0, 'lean-gain': 250, 'bulk': 500 };
  const calories = Math.round(tdee + (adjustments[goal] || 0));
  const protein = Math.round(weight * proteinRatio);
  const fats = Math.round((calories * (fatRatio / 100)) / 9);
  const carbs = Math.round((calories - (protein * 4) - (fats * 9)) / 4);
  
  document.getElementById('calc-calories').textContent = calories.toLocaleString();
  document.getElementById('calc-protein').textContent = protein + 'g';
  document.getElementById('calc-carbs').textContent = carbs + 'g';
  document.getElementById('calc-fats').textContent = fats + 'g';
  
  mealPlan.targetMacros = { calories, protein, carbs, fats };
}

function loadClientStats() {
  const client = document.getElementById('nutrition-client').value;
  const stats = {
    sarah: { weight: 145, bodyfat: 22 },
    mike: { weight: 185, bodyfat: 15 },
    emma: { weight: 135, bodyfat: 28 },
    david: { weight: 175, bodyfat: 12 }
  };
  if (stats[client]) {
    document.getElementById('client-weight').value = stats[client].weight;
    document.getElementById('client-bodyfat').value = stats[client].bodyfat;
    calculateMacros();
  }
}

function applyMacrosToBuilder() {
  document.getElementById('target-calories').textContent = mealPlan.targetMacros.calories.toLocaleString();
  document.getElementById('target-protein').textContent = mealPlan.targetMacros.protein + 'g';
  document.getElementById('target-carbs').textContent = mealPlan.targetMacros.carbs + 'g';
  document.getElementById('target-fats').textContent = mealPlan.targetMacros.fats + 'g';
}

function initMealBuilder() {
  const container = document.getElementById('meals-container');
  if (container.children.length === 0) {
    ['Breakfast', 'Lunch', 'Dinner', 'Snacks'].forEach(name => addMealSlot(name));
  }
  applyMacrosToBuilder();
}

function addMealSlot(name = 'New Meal') {
  const container = document.getElementById('meals-container');
  const mealId = 'meal-' + Date.now();
  const html = `
    <div class="meal-slot" id="${mealId}">
      <div class="meal-slot-header">
        <input type="text" value="${name}" class="meal-slot-name" style="background:transparent;border:none;color:#fff;font-weight:600;font-size:14px;">
        <span class="meal-slot-macros">0 cal</span>
      </div>
      <div class="meal-foods" data-meal="${mealId}"></div>
      <button class="add-food-btn" onclick="openFoodPicker('${mealId}')">+ Add Food</button>
    </div>
  `;
  container.insertAdjacentHTML('beforeend', html);
}

function openFoodPicker(mealId) {
  const foods = [
    { name: 'Grilled Chicken Breast', serving: '6 oz', cal: 280, p: 52, c: 0, f: 6 },
    { name: 'Brown Rice', serving: '1 cup', cal: 220, p: 5, c: 45, f: 2 },
    { name: 'Scrambled Eggs', serving: '3 large', cal: 220, p: 18, c: 2, f: 15 },
    { name: 'Greek Yogurt', serving: '1 cup', cal: 140, p: 20, c: 8, f: 0 },
    { name: 'Salmon Fillet', serving: '6 oz', cal: 350, p: 40, c: 0, f: 20 },
    { name: 'Sweet Potato', serving: '1 medium', cal: 115, p: 2, c: 27, f: 0 },
    { name: 'Broccoli', serving: '1 cup', cal: 55, p: 4, c: 10, f: 0 },
    { name: 'Oatmeal', serving: '1 cup', cal: 150, p: 5, c: 27, f: 3 },
    { name: 'Protein Shake', serving: '1 scoop', cal: 120, p: 24, c: 3, f: 1 },
    { name: 'Almonds', serving: '1 oz', cal: 165, p: 6, c: 6, f: 14 }
  ];
  
  const food = foods[Math.floor(Math.random() * foods.length)];
  addFoodToMeal(mealId, food);
}

function addFoodToMeal(mealId, food) {
  const container = document.querySelector(`[data-meal="${mealId}"]`);
  const foodId = 'food-' + Date.now();
  const html = `
    <div class="meal-food-item" id="${foodId}" data-cal="${food.cal}" data-p="${food.p}" data-c="${food.c}" data-f="${food.f}">
      <div>
        <div class="meal-food-name">${food.name}</div>
        <div class="meal-food-macros">${food.serving} • ${food.cal} cal • ${food.p}P ${food.c}C ${food.f}F</div>
      </div>
      <span class="meal-food-remove" onclick="removeFoodFromMeal('${foodId}')">✕</span>
    </div>
  `;
  container.insertAdjacentHTML('beforeend', html);
  updateDailyTotals();
}

function removeFoodFromMeal(foodId) {
  document.getElementById(foodId)?.remove();
  updateDailyTotals();
}

function updateDailyTotals() {
  let totals = { cal: 0, p: 0, c: 0, f: 0 };
  document.querySelectorAll('.meal-food-item').forEach(item => {
    totals.cal += parseInt(item.dataset.cal) || 0;
    totals.p += parseInt(item.dataset.p) || 0;
    totals.c += parseInt(item.dataset.c) || 0;
    totals.f += parseInt(item.dataset.f) || 0;
  });
  
  document.getElementById('daily-calories').textContent = totals.cal.toLocaleString();
  document.getElementById('daily-protein').textContent = totals.p + 'g';
  document.getElementById('daily-carbs').textContent = totals.c + 'g';
  document.getElementById('daily-fats').textContent = totals.f + 'g';
}

function saveMealPlan() {
  const client = document.getElementById('nutrition-client').value || 'client';
  alert(`Meal plan saved for ${client}! Target: ${mealPlan.targetMacros.calories} cal, ${mealPlan.targetMacros.protein}g protein`);
}

// Nutrition AI
function useNutritionPrompt(type) {
  const prompts = {
    'fat-loss': 'Create a fat loss meal plan for Sarah. She weighs 145lbs, 22% body fat, trains 4x/week. Target 1,650 calories with high protein.',
    'muscle-gain': 'Create a muscle building plan for Mike. He weighs 185lbs, 15% body fat, trains 5x/week. Target 2,800 calories.',
    'maintenance': 'Create a maintenance plan with balanced macros for a moderately active client.',
    'keto': 'Create a ketogenic meal plan with under 30g net carbs, high fat, moderate protein.',
    'vegan': 'Create a high-protein vegan meal plan for muscle building. Include complete protein sources.'
  };
  document.getElementById('nutrition-ai-input').value = prompts[type] || '';
}

function sendNutritionAIMessage() {
  const input = document.getElementById('nutrition-ai-input');
  const message = input.value.trim();
  if (!message) return;
  
  const container = document.getElementById('nutrition-ai-messages');
  container.innerHTML += `
    <div style="display:flex;gap:12px;margin-bottom:16px;justify-content:flex-end;">
      <div style="background:#4169E1;border-radius:12px;padding:14px;max-width:85%;">
        <div style="font-size:11px;color:rgba(255,255,255,0.7);margin-bottom:6px;">You</div>
        <div style="line-height:1.5;font-size:14px;">${message}</div>
      </div>
    </div>
  `;
  
  setTimeout(() => {
    const plan = generateAIMealPlan(message);
    container.innerHTML += `
      <div style="display:flex;gap:12px;margin-bottom:16px;">
        <div style="width:36px;height:36px;border-radius:10px;background:linear-gradient(135deg,#00ff88,#4169E1);display:flex;align-items:center;justify-content:center;flex-shrink:0;">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="#fff"><path d="M18.06 22.99h1.66c.84 0 1.53-.64 1.63-1.46L23 5.05l-5 2v16.94h.06zM1 21.99h15.03V3.95l-5-2-10 2v18.04z"/></svg>
        </div>
        <div style="background:#1a1a1a;border-radius:12px;padding:14px;max-width:85%;">
          <div style="font-size:11px;color:#00ff88;margin-bottom:6px;">Nutrition AI</div>
          <div style="line-height:1.5;font-size:14px;">${plan}</div>
        </div>
      </div>
    `;
    container.scrollTop = container.scrollHeight;
    updatePlanPreview();
  }, 800);
  
  input.value = '';
  container.scrollTop = container.scrollHeight;
}

function generateAIMealPlan(prompt) {
  const isLoss = prompt.toLowerCase().includes('loss') || prompt.toLowerCase().includes('cut');
  const isGain = prompt.toLowerCase().includes('gain') || prompt.toLowerCase().includes('bulk') || prompt.toLowerCase().includes('muscle');
  const isKeto = prompt.toLowerCase().includes('keto');
  const isVegan = prompt.toLowerCase().includes('vegan');
  
  let response = `Here's a customized meal plan based on your requirements:\n\n`;
  response += `<strong>Daily Targets:</strong> ${isLoss ? '1,650' : isGain ? '2,800' : '2,200'} cal | `;
  response += `${isLoss ? '145' : isGain ? '200' : '165'}g protein | `;
  response += `${isKeto ? '25' : isLoss ? '140' : '250'}g carbs | `;
  response += `${isKeto ? '130' : '65'}g fat\n\n`;
  
  if (isKeto) {
    response += `<strong>Breakfast:</strong> 3 eggs + avocado + bacon (450 cal)\n`;
    response += `<strong>Lunch:</strong> Salmon salad with olive oil (550 cal)\n`;
    response += `<strong>Dinner:</strong> Ribeye steak + asparagus (650 cal)\n`;
  } else if (isVegan) {
    response += `<strong>Breakfast:</strong> Tofu scramble + tempeh bacon (420 cal)\n`;
    response += `<strong>Lunch:</strong> Lentil curry + quinoa (580 cal)\n`;
    response += `<strong>Dinner:</strong> Seitan stir-fry + edamame (620 cal)\n`;
    response += `<strong>Snacks:</strong> Protein shake + nuts (380 cal)\n`;
  } else {
    response += `<strong>Breakfast:</strong> Eggs + oatmeal + berries (${isLoss ? '380' : '520'} cal)\n`;
    response += `<strong>Lunch:</strong> Chicken + rice + vegetables (${isLoss ? '480' : '680'} cal)\n`;
    response += `<strong>Dinner:</strong> Salmon + sweet potato + salad (${isLoss ? '520' : '720'} cal)\n`;
    response += `<strong>Snacks:</strong> Greek yogurt + protein shake (${isLoss ? '270' : '380'} cal)\n`;
  }
  
  response += `\n✅ Plan optimized for ${isLoss ? 'fat loss while preserving muscle' : isGain ? 'lean muscle gain' : 'maintenance'}`;
  return response;
}

function updatePlanPreview() {
  document.getElementById('generated-plan-preview').innerHTML = `
    <div style="background:#0a0a0a;border-radius:10px;padding:14px;margin-bottom:12px;">
      <div style="font-weight:600;margin-bottom:8px;">Daily Macros</div>
      <div style="display:flex;justify-content:space-between;font-size:13px;">
        <span>1,650 cal</span><span style="color:#4169E1;">145g P</span><span style="color:#ffcc00;">140g C</span><span style="color:#ff6b6b;">55g F</span>
      </div>
    </div>
    <div class="meal-slot" style="margin-bottom:8px;padding:12px;">
      <div style="font-weight:600;font-size:13px;margin-bottom:6px;">🌅 Breakfast</div>
      <div style="font-size:12px;color:#888;">Eggs + Oatmeal + Berries • 380 cal</div>
    </div>
    <div class="meal-slot" style="margin-bottom:8px;padding:12px;">
      <div style="font-weight:600;font-size:13px;margin-bottom:6px;">☀️ Lunch</div>
      <div style="font-size:12px;color:#888;">Chicken + Rice + Vegetables • 480 cal</div>
    </div>
    <div class="meal-slot" style="margin-bottom:8px;padding:12px;">
      <div style="font-weight:600;font-size:13px;margin-bottom:6px;">🌙 Dinner</div>
      <div style="font-size:12px;color:#888;">Salmon + Sweet Potato + Salad • 520 cal</div>
    </div>
    <div class="meal-slot" style="padding:12px;">
      <div style="font-weight:600;font-size:13px;margin-bottom:6px;">🥤 Snacks</div>
      <div style="font-size:12px;color:#888;">Greek Yogurt + Protein Shake • 270 cal</div>
    </div>
    <button class="btn" style="width:100%;margin-top:12px;" onclick="alert('Plan assigned to client!')">Assign to Client</button>
  `;
}

// Food Database
function loadFoodDatabase() {
  foodDatabase = [
    { name: 'Chicken Breast', serving: '6 oz', cal: 280, p: 52, c: 0, f: 6, category: 'protein' },
    { name: 'Salmon', serving: '6 oz', cal: 350, p: 40, c: 0, f: 20, category: 'protein' },
    { name: 'Ground Beef 90%', serving: '6 oz', cal: 310, p: 46, c: 0, f: 14, category: 'protein' },
    { name: 'Eggs', serving: '2 large', cal: 140, p: 12, c: 1, f: 10, category: 'protein' },
    { name: 'Greek Yogurt', serving: '1 cup', cal: 140, p: 20, c: 8, f: 0, category: 'dairy' },
    { name: 'Brown Rice', serving: '1 cup', cal: 220, p: 5, c: 45, f: 2, category: 'carbs' },
    { name: 'Sweet Potato', serving: '1 medium', cal: 115, p: 2, c: 27, f: 0, category: 'carbs' },
    { name: 'Oatmeal', serving: '1 cup', cal: 150, p: 5, c: 27, f: 3, category: 'carbs' },
    { name: 'Quinoa', serving: '1 cup', cal: 220, p: 8, c: 39, f: 4, category: 'carbs' },
    { name: 'Avocado', serving: '1 medium', cal: 240, p: 3, c: 12, f: 22, category: 'fats' },
    { name: 'Almonds', serving: '1 oz', cal: 165, p: 6, c: 6, f: 14, category: 'fats' },
    { name: 'Olive Oil', serving: '1 tbsp', cal: 120, p: 0, c: 0, f: 14, category: 'fats' },
    { name: 'Broccoli', serving: '1 cup', cal: 55, p: 4, c: 10, f: 0, category: 'vegetables' },
    { name: 'Spinach', serving: '2 cups', cal: 14, p: 2, c: 2, f: 0, category: 'vegetables' },
    { name: 'Banana', serving: '1 medium', cal: 105, p: 1, c: 27, f: 0, category: 'fruits' },
    { name: 'Blueberries', serving: '1 cup', cal: 85, p: 1, c: 21, f: 0, category: 'fruits' }
  ];
  renderFoodDatabase();
}

function renderFoodDatabase(foods = foodDatabase) {
  const grid = document.getElementById('food-database-grid');
  grid.innerHTML = foods.map(f => `
    <div class="food-card" onclick="selectFood('${f.name}')">
      <div class="food-card-name">${f.name}</div>
      <div class="food-card-serving">${f.serving}</div>
      <div class="food-card-macros">
        <span class="food-card-macro">${f.cal} cal</span>
        <span class="food-card-macro" style="color:#4169E1;">${f.p}P</span>
        <span class="food-card-macro" style="color:#ffcc00;">${f.c}C</span>
        <span class="food-card-macro" style="color:#ff6b6b;">${f.f}F</span>
      </div>
    </div>
  `).join('');
  document.getElementById('food-database-status').textContent = `${foods.length} foods in database`;
}

function searchFoods() {
  const term = document.getElementById('food-search-input').value.toLowerCase();
  const filtered = foodDatabase.filter(f => f.name.toLowerCase().includes(term));
  renderFoodDatabase(filtered);
}

function filterFoods() {
  const category = document.getElementById('food-category-filter').value;
  const filtered = category ? foodDatabase.filter(f => f.category === category) : foodDatabase;
  renderFoodDatabase(filtered);
}

function selectFood(name) {
  const food = foodDatabase.find(f => f.name === name);
  if (food) alert(`Selected: ${food.name}\n${food.cal} cal | ${food.p}g P | ${food.c}g C | ${food.f}g F`);
}

function addCustomFood() {
  const name = document.getElementById('custom-food-name').value;
  const cal = parseInt(document.getElementById('custom-calories').value) || 0;
  const p = parseInt(document.getElementById('custom-protein').value) || 0;
  const c = parseInt(document.getElementById('custom-carbs').value) || 0;
  const f = parseInt(document.getElementById('custom-fat').value) || 0;
  const category = document.getElementById('custom-category').value;
  const amount = document.getElementById('custom-serving-amount').value || '100';
  const unit = document.getElementById('custom-serving-unit').value;
  
  if (!name) { alert('Please enter a food name'); return; }
  
  foodDatabase.push({ name, serving: `${amount} ${unit}`, cal, p, c, f, category });
  renderFoodDatabase();
  alert(`Added "${name}" to database!`);
}

function addPresetFood(type) {
  const presets = {
    chicken: { name: 'Grilled Chicken', serving: '6 oz', cal: 280, p: 52, c: 0, f: 6, category: 'protein' },
    rice: { name: 'White Rice', serving: '1 cup', cal: 205, p: 4, c: 45, f: 0, category: 'carbs' },
    eggs: { name: 'Whole Eggs', serving: '2 large', cal: 140, p: 12, c: 1, f: 10, category: 'protein' },
    salmon: { name: 'Atlantic Salmon', serving: '6 oz', cal: 350, p: 40, c: 0, f: 20, category: 'protein' },
    oats: { name: 'Rolled Oats', serving: '1 cup', cal: 150, p: 5, c: 27, f: 3, category: 'carbs' },
    broccoli: { name: 'Steamed Broccoli', serving: '1 cup', cal: 55, p: 4, c: 10, f: 0, category: 'vegetables' }
  };
  if (presets[type]) {
    foodDatabase.push(presets[type]);
    renderFoodDatabase();
    alert(`Added ${presets[type].name} to database!`);
  }
}

function viewPlan(clientId) {
  showNutritionTab('create');
  document.getElementById('nutrition-client').value = clientId;
  loadClientStats();
}

// ==================== PROGRAM STUDIO ====================

// Studio State
let studioExercises = [];
let programData = {
  title: 'New Program',
  client: '',
  weeks: 4,
  currentWeek: 1,
  days: {
    1: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] },
    2: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] },
    3: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] },
    4: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] }
  }
};
let programHistory = [];
let historyIndex = -1;

// Load exercises for studio
function loadStudioExercises() {
  // Demo exercises for the studio
  studioExercises = [
    { id: 1, name: 'Barbell Bench Press', bodyPart: 'chest', equipment: 'barbell' },
    { id: 2, name: 'Incline Dumbbell Press', bodyPart: 'chest', equipment: 'dumbbell' },
    { id: 3, name: 'Cable Flyes', bodyPart: 'chest', equipment: 'cable' },
    { id: 4, name: 'Barbell Row', bodyPart: 'back', equipment: 'barbell' },
    { id: 5, name: 'Lat Pulldown', bodyPart: 'back', equipment: 'cable' },
    { id: 6, name: 'Seated Cable Row', bodyPart: 'back', equipment: 'cable' },
    { id: 7, name: 'Overhead Press', bodyPart: 'shoulders', equipment: 'barbell' },
    { id: 8, name: 'Lateral Raises', bodyPart: 'shoulders', equipment: 'dumbbell' },
    { id: 9, name: 'Face Pulls', bodyPart: 'shoulders', equipment: 'cable' },
    { id: 10, name: 'Barbell Curl', bodyPart: 'upper arms', equipment: 'barbell' },
    { id: 11, name: 'Tricep Pushdown', bodyPart: 'upper arms', equipment: 'cable' },
    { id: 12, name: 'Hammer Curls', bodyPart: 'upper arms', equipment: 'dumbbell' },
    { id: 13, name: 'Barbell Squat', bodyPart: 'upper legs', equipment: 'barbell' },
    { id: 14, name: 'Romanian Deadlift', bodyPart: 'upper legs', equipment: 'barbell' },
    { id: 15, name: 'Leg Press', bodyPart: 'upper legs', equipment: 'machine' },
    { id: 16, name: 'Leg Curl', bodyPart: 'upper legs', equipment: 'machine' },
    { id: 17, name: 'Leg Extension', bodyPart: 'upper legs', equipment: 'machine' },
    { id: 18, name: 'Calf Raises', bodyPart: 'lower legs', equipment: 'machine' },
    { id: 19, name: 'Plank', bodyPart: 'waist', equipment: 'body weight' },
    { id: 20, name: 'Cable Crunch', bodyPart: 'waist', equipment: 'cable' },
    { id: 21, name: 'Pull-ups', bodyPart: 'back', equipment: 'body weight' },
    { id: 22, name: 'Dips', bodyPart: 'chest', equipment: 'body weight' },
    { id: 23, name: 'Push-ups', bodyPart: 'chest', equipment: 'body weight' },
    { id: 24, name: 'Deadlift', bodyPart: 'back', equipment: 'barbell' }
  ];
  renderStudioExercises();
}

function renderStudioExercises(exercises = studioExercises) {
  const list = document.getElementById('studio-exercise-list');
  list.innerHTML = exercises.map(ex => `
    <div class="studio-exercise-item" draggable="true" ondragstart="dragStart(event, ${ex.id})" data-id="${ex.id}">
      <div class="studio-exercise-name">${ex.name}</div>
      <div class="studio-exercise-meta">
        <span class="studio-exercise-tag bodypart">${ex.bodyPart}</span>
        <span class="studio-exercise-tag equipment">${ex.equipment}</span>
      </div>
    </div>
  `).join('');
  document.getElementById('exercise-count').textContent = `${exercises.length} exercises`;
}

function filterStudioExercises() {
  const search = document.getElementById('studio-exercise-search').value.toLowerCase();
  const bodyPart = document.getElementById('studio-bodypart').value.toLowerCase();
  const equipment = document.getElementById('studio-equipment').value.toLowerCase();
  
  let filtered = studioExercises;
  if (search) filtered = filtered.filter(ex => ex.name.toLowerCase().includes(search));
  if (bodyPart) filtered = filtered.filter(ex => ex.bodyPart.toLowerCase().includes(bodyPart));
  if (equipment) filtered = filtered.filter(ex => ex.equipment.toLowerCase().includes(equipment));
  
  renderStudioExercises(filtered);
}

// Drag and Drop
function dragStart(event, exerciseId) {
  event.dataTransfer.setData('exerciseId', exerciseId);
  event.target.classList.add('dragging');
}

function allowDrop(event) {
  event.preventDefault();
  event.currentTarget.classList.add('drag-over');
}

function dropExercise(event, dayNum) {
  event.preventDefault();
  event.currentTarget.classList.remove('drag-over');
  
  const exerciseId = parseInt(event.dataTransfer.getData('exerciseId'));
  const exercise = studioExercises.find(ex => ex.id === exerciseId);
  
  if (exercise) {
    saveToHistory();
    const week = programData.currentWeek;
    const newExercise = {
      ...exercise,
      uid: Date.now(),
      sets: [{ reps: 10, weight: '' }, { reps: 10, weight: '' }, { reps: 10, weight: '' }]
    };
    programData.days[week][dayNum].push(newExercise);
    renderDayExercises(dayNum);
    updateProgramStats();
  }
  
  document.querySelectorAll('.dragging').forEach(el => el.classList.remove('dragging'));
}

function renderDayExercises(dayNum) {
  const container = document.getElementById(`day-${dayNum}-exercises`);
  const week = programData.currentWeek;
  const exercises = programData.days[week][dayNum];
  
  if (exercises.length === 0) {
    container.innerHTML = '<div class="drop-zone-hint">Drag exercises here</div>';
    return;
  }
  
  container.innerHTML = exercises.map((ex, idx) => `
    <div class="program-exercise" draggable="true">
      <div class="program-exercise-remove" onclick="removeExercise(${dayNum}, ${idx})">×</div>
      <div class="program-exercise-name">${ex.name}</div>
      <div class="program-exercise-sets">
        ${ex.sets.map((s, i) => `<span class="program-exercise-set">${s.reps}r</span>`).join('')}
      </div>
    </div>
  `).join('');
}

function removeExercise(dayNum, index) {
  saveToHistory();
  const week = programData.currentWeek;
  programData.days[week][dayNum].splice(index, 1);
  renderDayExercises(dayNum);
  updateProgramStats();
}

// Week Management
function selectWeek(weekNum) {
  programData.currentWeek = weekNum;
  document.querySelectorAll('.week-tab').forEach((tab, i) => {
    tab.classList.toggle('active', i + 1 === weekNum);
  });
  renderAllDays();
}

function changeWeek(direction) {
  const newWeek = programData.currentWeek + direction;
  if (newWeek >= 1 && newWeek <= programData.weeks) {
    selectWeek(newWeek);
  }
}

function addWeek() {
  programData.weeks++;
  programData.days[programData.weeks] = { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] };
  renderWeekTabs();
  selectWeek(programData.weeks);
}

function renderWeekTabs() {
  const container = document.getElementById('week-tabs');
  container.innerHTML = '';
  for (let i = 1; i <= programData.weeks; i++) {
    const btn = document.createElement('button');
    btn.className = 'week-tab' + (i === programData.currentWeek ? ' active' : '');
    btn.textContent = `Week ${i}`;
    btn.onclick = () => selectWeek(i);
    container.appendChild(btn);
  }
}

function renderAllDays() {
  for (let i = 1; i <= 7; i++) {
    renderDayExercises(i);
  }
}

// History (Undo/Redo)
function saveToHistory() {
  programHistory = programHistory.slice(0, historyIndex + 1);
  programHistory.push(JSON.parse(JSON.stringify(programData.days)));
  historyIndex++;
  if (programHistory.length > 50) {
    programHistory.shift();
    historyIndex--;
  }
}

function undoProgramChange() {
  if (historyIndex > 0) {
    historyIndex--;
    programData.days = JSON.parse(JSON.stringify(programHistory[historyIndex]));
    renderAllDays();
    updateProgramStats();
  }
}

function redoProgramChange() {
  if (historyIndex < programHistory.length - 1) {
    historyIndex++;
    programData.days = JSON.parse(JSON.stringify(programHistory[historyIndex]));
    renderAllDays();
    updateProgramStats();
  }
}

// Program Stats
function updateProgramStats() {
  let totalExercises = 0;
  let totalSets = 0;
  
  const week = programData.currentWeek;
  for (let day = 1; day <= 7; day++) {
    const exercises = programData.days[week][day];
    totalExercises += exercises.length;
    exercises.forEach(ex => totalSets += ex.sets.length);
  }
  
  document.getElementById('stat-exercises').textContent = totalExercises;
  document.getElementById('stat-sets').textContent = totalSets;
  document.getElementById('stat-volume').textContent = totalSets * 10; // Simplified volume calc
}

// AI Studio Assistant
function sendAIStudioMessage() {
  const input = document.getElementById('ai-studio-input');
  const message = input.value.trim();
  if (!message) return;
  
  const chat = document.getElementById('ai-studio-chat');
  chat.innerHTML += `<div class="ai-studio-msg user"><div class="ai-studio-msg-content">${message}</div></div>`;
  input.value = '';
  
  // Simulate AI response
  setTimeout(() => {
    let response = processAIStudioCommand(message);
    chat.innerHTML += `<div class="ai-studio-msg assistant"><div class="ai-studio-msg-content">${response}</div></div>`;
    chat.scrollTop = chat.scrollHeight;
  }, 500);
}

function aiStudioCommand(command) {
  const chat = document.getElementById('ai-studio-chat');
  let response = '';
  
  switch(command) {
    case 'generate':
      response = generateAIProgram();
      break;
    case 'deload':
      response = addDeloadWeek();
      break;
    case 'progress':
      response = addProgression();
      break;
    case 'balance':
      response = balanceVolume();
      break;
  }
  
  chat.innerHTML += `<div class="ai-studio-msg assistant"><div class="ai-studio-msg-content">${response}</div></div>`;
  chat.scrollTop = chat.scrollHeight;
}

function processAIStudioCommand(message) {
  const lower = message.toLowerCase();
  
  if (lower.includes('generate') || lower.includes('create program')) {
    return generateAIProgram();
  } else if (lower.includes('deload')) {
    return addDeloadWeek();
  } else if (lower.includes('chest') && lower.includes('monday')) {
    addExercisesToDay(1, ['chest']);
    return "Added chest exercises to Monday. I've included Bench Press, Incline Press, and Cable Flyes.";
  } else if (lower.includes('back') && lower.includes('tuesday')) {
    addExercisesToDay(2, ['back']);
    return "Added back exercises to Tuesday. I've included Barbell Row, Lat Pulldown, and Seated Cable Row.";
  } else if (lower.includes('legs') && lower.includes('thursday')) {
    addExercisesToDay(4, ['upper legs']);
    return "Added leg exercises to Thursday. I've included Squats, Romanian Deadlifts, and Leg Press.";
  } else if (lower.includes('progression') || lower.includes('progressive')) {
    return addProgression();
  } else if (lower.includes('balance')) {
    return balanceVolume();
  }
  
  return "I can help with that! Try commands like 'Generate a 4-week program', 'Add chest exercises to Monday', or 'Make week 4 a deload week'.";
}

function generateAIProgram() {
  saveToHistory();
  
  // Generate a PPL split
  const pushExercises = studioExercises.filter(ex => ['chest', 'shoulders'].includes(ex.bodyPart) || ex.name.includes('Tricep'));
  const pullExercises = studioExercises.filter(ex => ['back'].includes(ex.bodyPart) || ex.name.includes('Curl'));
  const legExercises = studioExercises.filter(ex => ['upper legs', 'lower legs'].includes(ex.bodyPart));
  
  for (let week = 1; week <= programData.weeks; week++) {
    // Monday - Push
    programData.days[week][1] = pushExercises.slice(0, 4).map(ex => ({
      ...ex, uid: Date.now() + Math.random(),
      sets: [{ reps: 10 }, { reps: 10 }, { reps: 10 }]
    }));
    
    // Tuesday - Pull
    programData.days[week][2] = pullExercises.slice(0, 4).map(ex => ({
      ...ex, uid: Date.now() + Math.random(),
      sets: [{ reps: 10 }, { reps: 10 }, { reps: 10 }]
    }));
    
    // Wednesday - Rest
    programData.days[week][3] = [];
    
    // Thursday - Legs
    programData.days[week][4] = legExercises.slice(0, 4).map(ex => ({
      ...ex, uid: Date.now() + Math.random(),
      sets: [{ reps: 10 }, { reps: 10 }, { reps: 10 }]
    }));
    
    // Friday - Upper
    programData.days[week][5] = [...pushExercises.slice(0, 2), ...pullExercises.slice(0, 2)].map(ex => ({
      ...ex, uid: Date.now() + Math.random(),
      sets: [{ reps: 10 }, { reps: 10 }, { reps: 10 }]
    }));
    
    // Saturday - Cardio/Active Recovery
    programData.days[week][6] = [];
    
    // Sunday - Rest
    programData.days[week][7] = [];
  }
  
  renderAllDays();
  updateProgramStats();
  
  return "Generated a 4-week Push/Pull/Legs program! Monday is Push, Tuesday is Pull, Thursday is Legs, Friday is Upper body. Feel free to drag exercises to customize.";
}

function addExercisesToDay(dayNum, bodyParts) {
  saveToHistory();
  const week = programData.currentWeek;
  const exercises = studioExercises.filter(ex => bodyParts.includes(ex.bodyPart)).slice(0, 3);
  
  exercises.forEach(ex => {
    programData.days[week][dayNum].push({
      ...ex, uid: Date.now() + Math.random(),
      sets: [{ reps: 10 }, { reps: 10 }, { reps: 10 }]
    });
  });
  
  renderDayExercises(dayNum);
  updateProgramStats();
}

function addDeloadWeek() {
  saveToHistory();
  const lastWeek = programData.weeks;
  
  // Copy last week but reduce sets
  for (let day = 1; day <= 7; day++) {
    programData.days[lastWeek][day] = programData.days[lastWeek][day].map(ex => ({
      ...ex,
      sets: ex.sets.slice(0, 2).map(s => ({ ...s, reps: Math.max(6, s.reps - 2) }))
    }));
  }
  
  renderAllDays();
  updateProgramStats();
  
  return `Week ${lastWeek} is now a deload week with reduced volume (2 sets per exercise, lower reps).`;
}

function addProgression() {
  saveToHistory();
  
  // Add progressive overload across weeks
  for (let week = 2; week <= programData.weeks; week++) {
    for (let day = 1; day <= 7; day++) {
      programData.days[week][day] = programData.days[week][day].map(ex => ({
        ...ex,
        sets: ex.sets.map(s => ({ ...s, reps: Math.min(12, s.reps + 1) }))
      }));
    }
  }
  
  renderAllDays();
  return "Added progressive overload: reps increase by 1 each week (up to 12). This creates a natural progression curve.";
}

function balanceVolume() {
  const week = programData.currentWeek;
  let bodyPartVolume = {};
  
  for (let day = 1; day <= 7; day++) {
    programData.days[week][day].forEach(ex => {
      if (!bodyPartVolume[ex.bodyPart]) bodyPartVolume[ex.bodyPart] = 0;
      bodyPartVolume[ex.bodyPart] += ex.sets.length;
    });
  }
  
  let report = "Weekly volume by body part:\n";
  Object.entries(bodyPartVolume).forEach(([part, sets]) => {
    report += `• ${part}: ${sets} sets\n`;
  });
  
  return report + "\nFor balanced development, aim for 10-20 sets per muscle group per week.";
}

// Save Program
function saveProgramStudio() {
  const title = document.getElementById('program-title').value;
  const client = document.getElementById('program-client').value;
  
  const program = {
    title,
    client,
    weeks: programData.weeks,
    days: programData.days,
    createdAt: new Date().toISOString()
  };
  
  // In a real app, this would save to a database
  console.log('Saving program:', program);
  alert(`Program "${title}" saved successfully!`);
}

function showProgramsList() {
  showPage('programs');
}

// Programs page tab switching
function showProgramsTab(tab) {
  document.querySelectorAll('#page-programs .nutrition-tab').forEach(t => t.classList.remove('active'));
  event.target.classList.add('active');
  
  document.getElementById('programs-active').style.display = tab === 'active' ? 'grid' : 'none';
  document.getElementById('programs-templates').style.display = tab === 'templates' ? 'grid' : 'none';
  document.getElementById('programs-archived').style.display = tab === 'archived' ? 'block' : 'none';
}

function editProgram(programId) {
  // In a real app, this would load the program into the studio
  showPage('studio');
}

function useTemplate(templateId) {
  // In a real app, this would create a new program from the template
  showPage('studio');
}

function openNewProgramModal() {
  // Reset program data
  programData = {
    title: 'New Program',
    client: '',
    weeks: 4,
    currentWeek: 1,
    days: {
      1: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] },
      2: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] },
      3: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] },
      4: { 1: [], 2: [], 3: [], 4: [], 5: [], 6: [], 7: [] }
    }
  };
  document.getElementById('program-title').value = 'New Program';
  document.getElementById('program-client').value = '';
  renderWeekTabs();
  renderAllDays();
  updateProgramStats();
}

// Initialize studio when Programs page is shown
const originalShowPage = showPage;
showPage = function(pageId) {
  originalShowPage(pageId);
  if (pageId === 'studio') {
    loadStudioExercises();
    renderWeekTabs();
    renderAllDays();
    updateProgramStats();
  }
};

// Add drag leave handler
document.addEventListener('DOMContentLoaded', function() {
  document.querySelectorAll('.day-exercises').forEach(el => {
    el.addEventListener('dragleave', function(e) {
      this.classList.remove('drag-over');
    });
  });
});
</script>
</body>
</html>
